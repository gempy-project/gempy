
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>gempy.core.model &#8212; GemPy 2.2.8 documentation</title>
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/gallery-rendered-html.css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for gempy.core.model</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pn</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Iterable</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">gempy.core.data_modules.geometric_data</span> <span class="kn">import</span> <span class="n">Orientations</span><span class="p">,</span> <span class="n">SurfacePoints</span><span class="p">,</span> \
    <span class="n">ScalingSystem</span><span class="p">,</span> <span class="n">Surfaces</span><span class="p">,</span> <span class="n">Grid</span>
<span class="kn">from</span> <span class="nn">gempy.core.data_modules.stack</span> <span class="kn">import</span> <span class="n">Stack</span><span class="p">,</span> <span class="n">Faults</span><span class="p">,</span> <span class="n">Series</span>
<span class="kn">from</span> <span class="nn">gempy.core.data</span> <span class="kn">import</span> <span class="n">AdditionalData</span><span class="p">,</span> <span class="n">MetaData</span><span class="p">,</span> <span class="n">Options</span><span class="p">,</span> <span class="n">Structure</span><span class="p">,</span> \
    <span class="n">KrigingParameters</span>
<span class="kn">from</span> <span class="nn">gempy.core.solution</span> <span class="kn">import</span> <span class="n">Solution</span>
<span class="kn">from</span> <span class="nn">gempy.core.interpolator</span> <span class="kn">import</span> <span class="n">InterpolatorModel</span><span class="p">,</span> <span class="n">InterpolatorGravity</span>
<span class="kn">from</span> <span class="nn">gempy.utils.meta</span> <span class="kn">import</span> <span class="n">_setdoc</span><span class="p">,</span> <span class="n">_setdoc_pro</span>
<span class="kn">import</span> <span class="nn">gempy.utils.docstring</span> <span class="k">as</span> <span class="nn">ds</span>
<span class="kn">from</span> <span class="nn">gempy.plot.decorators</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">pn</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">chained_assignment</span> <span class="o">=</span> <span class="kc">None</span>


<span class="k">class</span> <span class="nc">RestrictingWrapper</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">accepted_members</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;__repr__&#39;</span><span class="p">,</span> <span class="s1">&#39;_repr_html_&#39;</span><span class="p">,</span> <span class="s1">&#39;__str__&#39;</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_w</span> <span class="o">=</span> <span class="n">w</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_accepted_members</span> <span class="o">=</span> <span class="n">accepted_members</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accepted_members</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_w</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>


<div class="viewcode-block" id="ImplicitCoKriging"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging">[docs]</a><span class="nd">@_setdoc_pro</span><span class="p">([</span><span class="n">Grid</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">Faults</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">Series</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">Surfaces</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span>
              <span class="n">SurfacePoints</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span>
              <span class="n">Orientations</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">ScalingSystem</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">AdditionalData</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span>
              <span class="n">InterpolatorModel</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span>
              <span class="n">Solution</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">])</span>
<span class="k">class</span> <span class="nc">ImplicitCoKriging</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class handles all the mutation of the data objects of the model involved on the</span>
<span class="sd">     implicit cokriging ensuring the synchronization of all the members.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        _grid (:class:`gempy.core.data.Grid`): [s0]</span>
<span class="sd">        _faults (:class:`gempy.core.data.Grid`): [s1]</span>
<span class="sd">        _stack (:class:`gempy.core.data_modules.stack.Stack`): [s2]</span>
<span class="sd">        _surfaces (:class:`gempy.core.data.Surfaces`): [s3]</span>
<span class="sd">        _surface_points (:class:`gempy.core.data_modules.geometric_data.SurfacePoints`): [s4]</span>
<span class="sd">        _orientations (:class:`gempy.core.data_modules.geometric_data.Orientations`): [s5]</span>
<span class="sd">        _rescaling (:class:`gempy.core.data_modules.geometric_data.Rescaling`): [s6]</span>
<span class="sd">        _additional_data (:class:`gempy.core.data.AdditionalData`): [s7]</span>
<span class="sd">        _interpolator (:class:`gempy.core.interpolator.InterpolatorModel`): [s8]</span>
<span class="sd">        solutions (:class:`gempy.core.solutions.Solutions`): [s9]</span>


<span class="sd">     &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ImplicitCoKriging.__init__"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="p">()</span>
        <span class="c1"># Old way</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_faults</span> <span class="o">=</span> <span class="n">Faults</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_faults</span><span class="p">)</span>

        <span class="c1"># New way</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span> <span class="o">=</span> <span class="n">Stack</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_faults</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">faults</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span> <span class="o">=</span> <span class="n">Surfaces</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span> <span class="o">=</span> <span class="n">SurfacePoints</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span> <span class="o">=</span> <span class="n">Orientations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rescaling</span> <span class="o">=</span> <span class="n">ScalingSystem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="p">,</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span> <span class="o">=</span> <span class="n">AdditionalData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">_faults</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rescaling</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span> <span class="o">=</span> <span class="n">InterpolatorModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_faults</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">solutions</span> <span class="o">=</span> <span class="n">Solution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="p">)</span>

        <span class="c1"># Previous values of sfai.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sfai_order_0</span> <span class="o">=</span> <span class="kc">None</span></div>

    <span class="nd">@_setdoc_pro</span><span class="p">(</span><span class="n">Grid</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">grid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; :class:`gempy.core.data.Grid` [s0]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">RestrictingWrapper</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">,</span>
            <span class="n">accepted_members</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;__repr__&#39;</span><span class="p">,</span> <span class="s1">&#39;__str__&#39;</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">,</span> <span class="s1">&#39;regular_grid&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;sections&#39;</span><span class="p">,</span> <span class="s1">&#39;centered_grid&#39;</span><span class="p">])</span>

    <span class="nd">@_setdoc_pro</span><span class="p">(</span><span class="n">Faults</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">faults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:class:`gempy.core.data_modules.stack.Faults` [s0]&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">RestrictingWrapper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_faults</span><span class="p">,</span>
                                  <span class="n">accepted_members</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;__repr__&#39;</span><span class="p">,</span> <span class="s1">&#39;_repr_html_&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;faults_relations_df&#39;</span><span class="p">])</span>

    <span class="nd">@_setdoc_pro</span><span class="p">(</span><span class="n">Stack</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stack</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:class:`gempy.core.data_modules.stack.Stack` [s0]&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">RestrictingWrapper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="p">,</span>
                                  <span class="n">accepted_members</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;__repr__&#39;</span><span class="p">,</span> <span class="s1">&#39;_repr_html_&#39;</span><span class="p">,</span> <span class="s1">&#39;df&#39;</span><span class="p">])</span>

    <span class="nd">@_setdoc_pro</span><span class="p">(</span><span class="n">Series</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">series</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;&quot;&quot;&quot;</span>
        <span class="c1"># warnings.warn(DeprecationWarning, &#39;series will be deprecated in the future.&#39;</span>
        <span class="c1">#                                  &#39;Use stack instead.&#39;)</span>
        <span class="k">return</span> <span class="n">RestrictingWrapper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="p">,</span>
                                  <span class="n">accepted_members</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;__repr__&#39;</span><span class="p">,</span> <span class="s1">&#39;_repr_html_&#39;</span><span class="p">,</span> <span class="s1">&#39;df&#39;</span><span class="p">])</span>

    <span class="nd">@_setdoc_pro</span><span class="p">(</span><span class="n">Surfaces</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">surfaces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:class:`gempy.core.data.Surfaces` [s0]&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">RestrictingWrapper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="p">,</span>
                                  <span class="n">accepted_members</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;__repr__&#39;</span><span class="p">,</span> <span class="s1">&#39;_repr_html_&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;colors&#39;</span><span class="p">,</span> <span class="s1">&#39;df&#39;</span><span class="p">])</span>

    <span class="nd">@_setdoc_pro</span><span class="p">(</span><span class="n">SurfacePoints</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">surface_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:class:`gempy.core.data_modules.geometric_data.SurfacePoints` [s0]&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">RestrictingWrapper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="p">,</span>
                                  <span class="n">accepted_members</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;__repr__&#39;</span><span class="p">,</span> <span class="s1">&#39;_repr_html_&#39;</span><span class="p">,</span> <span class="s1">&#39;df&#39;</span><span class="p">])</span>

    <span class="nd">@_setdoc_pro</span><span class="p">(</span><span class="n">Orientations</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">orientations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:class:`gempy.core.data_modules.geometric_data.Orientations` [s0]&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">RestrictingWrapper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="p">,</span>
                                  <span class="n">accepted_members</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;__repr__&#39;</span><span class="p">,</span> <span class="s1">&#39;_repr_html_&#39;</span><span class="p">,</span> <span class="s1">&#39;df&#39;</span><span class="p">])</span>

    <span class="nd">@_setdoc_pro</span><span class="p">(</span><span class="n">ScalingSystem</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rescaling</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:class:`gempy.core.data_modules.geometric_data.Rescaling` [s0]&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">RestrictingWrapper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rescaling</span><span class="p">)</span>

    <span class="nd">@_setdoc_pro</span><span class="p">(</span><span class="n">AdditionalData</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">additional_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:class:`gempy.core.data.AdditionalData` [s0]&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">RestrictingWrapper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="p">,</span>
                                  <span class="n">accepted_members</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;__repr__&#39;</span><span class="p">,</span> <span class="s1">&#39;_repr_html_&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;structure_data&#39;</span><span class="p">,</span> <span class="s1">&#39;options&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;kriging_parameters&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;kriging_data&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;rescaling_data&#39;</span><span class="p">])</span>

    <span class="nd">@_setdoc_pro</span><span class="p">(</span><span class="n">InterpolatorModel</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">interpolator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:class:`gempy.core.interpolator.InterpolatorModel` [s0]&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">RestrictingWrapper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="p">,</span>
                                  <span class="n">accepted_members</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;__repr__&#39;</span><span class="p">,</span> <span class="s1">&#39;_repr_html_&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;theano_graph&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_add_valid_idx_s</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">idx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">idx</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">:</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="p">(</span>
                <span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)),</span> <span class="s1">&#39;idx must be an int or a list of ints&#39;</span>

        <span class="k">return</span> <span class="n">idx</span>

    <span class="k">def</span> <span class="nf">_add_valid_idx_o</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">idx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">idx</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">:</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="p">(</span>
                <span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)),</span> <span class="s1">&#39;idx must be an int or a list of ints&#39;</span>

        <span class="k">return</span> <span class="n">idx</span>

<div class="viewcode-block" id="ImplicitCoKriging.update_structure"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.update_structure">[docs]</a>    <span class="nd">@_setdoc_pro</span><span class="p">([</span><span class="n">AdditionalData</span><span class="o">.</span><span class="n">update_structure</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span>
                  <span class="n">InterpolatorModel</span><span class="o">.</span><span class="n">set_theano_shared_structure</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span>
                  <span class="n">InterpolatorModel</span><span class="o">.</span><span class="n">modify_results_matrices_pro</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span>
                  <span class="n">InterpolatorModel</span><span class="o">.</span><span class="n">modify_results_weights</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">update_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update_theano</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update_series_is_active</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">update_surface_is_active</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update python and theano structure parameters.</span>

<span class="sd">        [s0]</span>
<span class="sd">        [s1]</span>

<span class="sd">        Args:</span>
<span class="sd">            update_theano (str{&#39;matrices&#39;, &#39;weights&#39;}):</span>

<span class="sd">                * matrices [s2]</span>

<span class="sd">                * weights [s3]</span>

<span class="sd">        Returns:</span>
<span class="sd">            :class:`gempy.core.data.Structure`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">update_structure</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">update_series_is_active</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">len_series_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">structure_data</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                               <span class="s1">&#39;values&#39;</span><span class="p">,</span> <span class="s1">&#39;len series surface_points&#39;</span><span class="p">]</span> <span class="o">-</span> \
                           <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">structure_data</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                               <span class="s1">&#39;values&#39;</span><span class="p">,</span> <span class="s1">&#39;number surfaces per series&#39;</span><span class="p">]</span>

            <span class="n">len_series_o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">structure_data</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                <span class="s1">&#39;values&#39;</span><span class="p">,</span> <span class="s1">&#39;len series orientations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
                <span class="s1">&#39;int32&#39;</span><span class="p">)</span>

            <span class="c1"># Remove series without data</span>
            <span class="n">non_zero_i</span> <span class="o">=</span> <span class="n">len_series_i</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">non_zero_o</span> <span class="o">=</span> <span class="n">len_series_o</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">non_zero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">non_zero_i</span><span class="p">,</span> <span class="n">non_zero_o</span><span class="p">)</span>

            <span class="n">bool_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;isActive&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
            <span class="n">bool_vec</span><span class="p">[</span><span class="n">non_zero</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;isActive&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bool_vec</span>

        <span class="k">if</span> <span class="n">update_surface_is_active</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">act_series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;isActive&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
            <span class="n">unique_surf_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_surf_points</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">bool_surf_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">act_series</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
                <span class="n">bool_surf_points</span><span class="p">[</span><span class="n">unique_surf_points</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="c1"># This is necessary to find the intersection between orientations</span>
                <span class="c1"># (series) and  surface points</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;isActive&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">act_series</span> <span class="o">&amp;</span> <span class="n">bool_surf_points</span><span class="p">)</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;isBasement&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;hasData&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">act_series</span> <span class="o">|</span> <span class="n">bool_surf_points</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">update_theano</span> <span class="o">==</span> <span class="s1">&#39;matrices&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">modify_results_matrices_pro</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">update_theano</span> <span class="o">==</span> <span class="s1">&#39;weights&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">modify_results_weights</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_theano_shared_structure</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">structure_data</span></div>

    <span class="c1"># region Grid</span>
<div class="viewcode-block" id="ImplicitCoKriging.update_from_grid"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.update_from_grid">[docs]</a>    <span class="k">def</span> <span class="nf">update_from_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update objects dependent from the grid.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rescaling</span><span class="o">.</span><span class="n">rescale_data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_initial_results_matrices</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">&#39;gravity&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">theano_graph</span><span class="o">.</span><span class="n">output</span> <span class="ow">or</span> <span class="s1">&#39;magnetics&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">theano_graph</span><span class="o">.</span><span class="n">output</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_theano_shared_l0_l1</span><span class="p">()</span>

        <span class="c1"># Check if grid is shared</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">theano_graph</span><span class="o">.</span><span class="n">grid_val_T</span><span class="p">,</span> <span class="s1">&#39;get_value&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">theano_graph</span><span class="o">.</span><span class="n">grid_val_T</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">values_r</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.set_active_grid"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_active_grid">[docs]</a>    <span class="k">def</span> <span class="nf">set_active_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid_name</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">reset</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set active a given or several grids.</span>

<span class="sd">        Args:</span>
<span class="sd">            grid_name (str, list[str]): Name of the grid you want to activate. Options are</span>
<span class="sd">             {regular, custom, topography, centered}</span>
<span class="sd">            reset (bool): If True set inactive all grids not in grid_name</span>

<span class="sd">        Returns:</span>
<span class="sd">            :class:`gempy.core.data.Grid`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">reset</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">deactivate_all_grids</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">set_active</span><span class="p">(</span><span class="n">grid_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_from_grid</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Active grids: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">grid_types</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">active_grids</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span></div>

    <span class="k">def</span> <span class="nf">get_active_grids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">grid_types</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">active_grids</span><span class="p">]</span>

<div class="viewcode-block" id="ImplicitCoKriging.set_grid_object"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_grid_object">[docs]</a>    <span class="k">def</span> <span class="nf">set_grid_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid</span><span class="p">:</span> <span class="n">Grid</span><span class="p">,</span> <span class="n">update_model</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Not implemented</span>

<span class="sd">        # TODO this should go to the api and let call all different grid types</span>

<span class="sd">        Args:</span>
<span class="sd">            grid:</span>
<span class="sd">            update_model:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># @_setdoc(Grid.create_regular_grid.__doc__)</span>
<div class="viewcode-block" id="ImplicitCoKriging.set_regular_grid"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_regular_grid">[docs]</a>    <span class="nd">@_setdoc_pro</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">set_regular_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extent</span><span class="p">,</span> <span class="n">resolution</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set a regular grid, rescale data and initialize theano solutions.</span>

<span class="sd">        Args:</span>
<span class="sd">            extent: [s_extent]</span>
<span class="sd">            resolution: [s_resolution]</span>

<span class="sd">        Returns:</span>
<span class="sd">            :class:`gempy.core.data.Grid`</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`gempy.core.data.Grid.create_regular_grid`</span>

<span class="sd">            :class:`gempy.core.data.grid_modules.grid_types.RegularGrid`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">regular_grid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">create_regular_grid</span><span class="p">(</span><span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">regular_grid</span><span class="o">.</span><span class="n">set_regular_grid</span><span class="p">(</span><span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
                                                     <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">set_active</span><span class="p">(</span><span class="s1">&#39;regular&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">topography</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">topography</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span>
            <span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">regular_grid</span><span class="o">.</span><span class="n">set_topography_mask</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">topography</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_from_grid</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Active grids: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">grid_types</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">active_grids</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.set_custom_grid"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_custom_grid">[docs]</a>    <span class="nd">@_setdoc_pro</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">set_custom_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">custom_grid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set custom grid, rescale gird and initialize theano solutions. foo</span>

<span class="sd">        Args:</span>
<span class="sd">            custom_grid: [s_coord]</span>

<span class="sd">        Returns:</span>
<span class="sd">            :class:`gempy.core.data.Grid`</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`gempy.core.data.Grid.create_custom_grid`</span>

<span class="sd">            :class:`gempy.core.data.grid_modules.grid_types.CustomGrid`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">custom_grid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">create_custom_grid</span><span class="p">(</span><span class="n">custom_grid</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">custom_grid</span><span class="o">.</span><span class="n">set_custom_grid</span><span class="p">(</span><span class="n">custom_grid</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">update_grid_values</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_from_grid</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Active grids: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">grid_types</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">active_grids</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.set_topography"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_topography">[docs]</a>    <span class="nd">@plot_set_topography</span>
    <span class="k">def</span> <span class="nf">set_topography</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="n">set_mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a topography grid and activate it.</span>

<span class="sd">        Args:</span>
<span class="sd">            source:</span>
<span class="sd">                * &#39;gdal&#39;: Load topography from a raster file.</span>
<span class="sd">                * &#39;random&#39;: Generate random topography (based on a fractal grid).</span>
<span class="sd">                * &#39;saved&#39;: Load topography that was saved with the topography.save() function.</span>
<span class="sd">                  this is useful after loading and saving a heavy raster file with gdal once</span>
<span class="sd">                  or after saving a random topography with the save() function. This .npy file can then be set as</span>
<span class="sd">                  topography.</span>

<span class="sd">        Keyword Args:</span>
<span class="sd">            source = &#39;gdal&#39;:</span>

<span class="sd">                * filepath: path to raster file, e.g. &#39;.tif&#39;, (for all file formats see</span>
<span class="sd">                  https://gdal.org/drivers/raster/index.html)</span>

<span class="sd">            source = &#39;random&#39;:</span>

<span class="sd">                * fd:         fractal dimension, defaults to 2.0</span>

<span class="sd">                * d_z:        maximum height difference. If none, last 20% of the model in z direction</span>

<span class="sd">                * extent:     extent in xy direction. If none, geo_model.grid.extent</span>

<span class="sd">                * resolution: desired resolution of the topography array. If none, geo_model.grid.resoution</span>

<span class="sd">            source = &#39;saved&#39;:</span>

<span class="sd">                * filepath:   path to the .npy file that was created using the topography.save() function</span>

<span class="sd">            source = &#39;numpy&#39;:</span>
<span class="sd">                * array: numpy array containing the data</span>

<span class="sd">        Returns:</span>
<span class="sd">             :class:`gempy.core.data.Grid`</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`gempy.core.grid_modules.grid_types.Topography`</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">create_topography</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">set_mask</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">regular_grid</span><span class="o">.</span><span class="n">set_topography_mask</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">topography</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_from_grid</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Active grids: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">grid_types</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">active_grids</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.set_centered_grid"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_centered_grid">[docs]</a>    <span class="nd">@_setdoc_pro</span><span class="p">(</span><span class="n">Grid</span><span class="o">.</span><span class="n">create_centered_grid</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">set_centered_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[s0]</span>

<span class="sd">        Args:</span>
<span class="sd">            centers (numpy.ndarray[float, 3]): Location of the center of each kernel.</span>
<span class="sd">            radius (float): Distance from each center to create each XYZ point</span>
<span class="sd">            resolution (numpy.ndarray[3]): Number of voxels in each direction per kernel</span>

<span class="sd">        Returns:</span>
<span class="sd">            :class:`gempy.core.data.Grid`</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`gempy.core.grid_modules.grid_types.CenteredGrid`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">centered_grid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">create_centered_grid</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">centered_grid</span><span class="o">.</span><span class="n">set_centered_grid</span><span class="p">(</span><span class="n">centers</span><span class="o">=</span><span class="n">centers</span><span class="p">,</span>
                                                       <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span>
                                                       <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">update_grid_values</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_active_grid</span><span class="p">(</span><span class="s1">&#39;centered&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_from_grid</span><span class="p">()</span>
        <span class="c1"># print(f&#39;Active grids: {self._grid.grid_types[self._grid.active_grids]}&#39;)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.set_section_grid"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_section_grid">[docs]</a>    <span class="nd">@_setdoc_pro</span><span class="p">(</span><span class="n">Grid</span><span class="o">.</span><span class="n">create_section_grid</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">set_section_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section_dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[s0]</span>

<span class="sd">        Args:</span>
<span class="sd">            section_dict: [s_section_dict]</span>

<span class="sd">        Returns:</span>
<span class="sd">            :class:`gempy.core.grid_modules.grid_types.Sections`</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`gempy.core.grid_modules.grid_types.Sections`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO being able to change the regular grid associated to the section grid</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">sections</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">create_section_grid</span><span class="p">(</span><span class="n">section_dict</span><span class="o">=</span><span class="n">section_dict</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">sections</span><span class="o">.</span><span class="n">set_sections</span><span class="p">(</span><span class="n">section_dict</span><span class="p">,</span>
                                             <span class="n">regular_grid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">regular_grid</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_active_grid</span><span class="p">(</span><span class="s1">&#39;sections&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_from_grid</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">sections</span></div>

    <span class="c1"># endregion</span>

    <span class="c1"># region Series</span>
<div class="viewcode-block" id="ImplicitCoKriging.set_series_object"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_series_object">[docs]</a>    <span class="k">def</span> <span class="nf">set_series_object</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Not implemented yet. Exchange the series object of the Model object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.set_bottom_relation"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_bottom_relation">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">([</span><span class="n">Series</span><span class="o">.</span><span class="n">set_bottom_relation</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">set_bottom_relation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">series</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
                            <span class="n">bottom_relation</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">set_bottom_relation</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">bottom_relation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_theano_shared_relations</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.add_features"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_features">[docs]</a>    <span class="nd">@_setdoc_pro</span><span class="p">(</span><span class="n">Stack</span><span class="o">.</span><span class="n">reset_order_series</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">add_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features_list</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span> <span class="n">reset_order_series</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Add series, update the categories dependent on them and reset the flow control.</span>

<span class="sd">        Args:</span>
<span class="sd">            features_list: (str, list): name or list of names of the series to apply the functionality</span>
<span class="sd">            reset_order_series: if true [s0]</span>

<span class="sd">        Returns:</span>
<span class="sd">            :class:`gempy.core.data_modules.stack.Stack`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="n">features_list</span><span class="p">,</span> <span class="n">reset_order_series</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="n">features_list</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="n">features_list</span><span class="p">,</span>
                                                             <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="n">features_list</span><span class="p">,</span>
                                                           <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_structure</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_flow_control</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_theano_shared_kriging</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.add_series"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_series">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">Series</span><span class="o">.</span><span class="n">add_series</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">add_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">series_list</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span> <span class="n">reset_order_series</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Series are getting renamed to Stack/features.&#39;</span>
                      <span class="s1">&#39;Please use add_features instead&#39;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">,</span> <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_features</span><span class="p">(</span><span class="n">series_list</span><span class="p">,</span> <span class="n">reset_order_series</span><span class="p">)</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.delete_features"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.delete_features">[docs]</a>    <span class="nd">@_setdoc_pro</span><span class="p">(</span><span class="n">Stack</span><span class="o">.</span><span class="n">reset_order_series</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">delete_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span> <span class="n">reset_order_features</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">remove_surfaces</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_data</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Delete series, update the categories dependent on them and reset the flow control.</span>

<span class="sd">        Args:</span>
<span class="sd">            indices (str, list): name or list of names of the series to apply the functionality</span>
<span class="sd">            reset_order_features: (bool): if true [s0]</span>
<span class="sd">            remove_surfaces (bool): if True remove the surfaces associated with the feature.</span>
<span class="sd">            remove_data (bool): if True remove the geometric data associated with the feature</span>

<span class="sd">        Returns:</span>
<span class="sd">             :class:`gempy.core.data_modules.stack.Stack`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">delete_series</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">reset_order_features</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">remove_surfaces</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">delete_surfaces</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;series&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">s</span><span class="p">)[</span><span class="s1">&#39;surface&#39;</span><span class="p">],</span>
                    <span class="n">remove_data</span><span class="o">=</span><span class="n">remove_data</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">remove_categories</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">remove_categories</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span>
                                                                <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">remove_categories</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map_geometric_data_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map_geometric_data_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_structure</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_theano_shared_relations</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_theano_shared_kriging</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_flow_control</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.delete_series"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.delete_series">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">delete_features</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">delete_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span> <span class="n">refactor_order_series</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">remove_surfaces</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_data</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="ne">DeprecationWarning</span><span class="p">,</span>
                      <span class="s1">&#39;Series are getting renamed to Stack/features.&#39;</span>
                      <span class="s1">&#39;Please use delete_features instead&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete_features</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">refactor_order_series</span><span class="p">,</span>
                                    <span class="n">remove_surfaces</span><span class="p">,</span> <span class="n">remove_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.rename_features"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.rename_features">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">Series</span><span class="o">.</span><span class="n">rename_series</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">rename_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_categories</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">list</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Rename features and update the category dependent on them.</span>

<span class="sd">        Args:</span>
<span class="sd">            new_categories (list, dict):</span>
<span class="sd">                * list-like: all items must be unique and the number of items in the new</span>
<span class="sd">                  categories must match the existing number of categories.</span>

<span class="sd">                * dict-like: specifies a mapping from old categories to new. Categories</span>
<span class="sd">                  not contained in the mapping are passed through and extra categories in the mapping are ignored.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :class:`gempy.core.data_modules.stack.Stack`</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">rename_series</span><span class="p">(</span><span class="n">new_categories</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">rename_categories</span><span class="p">(</span><span class="n">new_categories</span><span class="p">,</span>
                                                          <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">rename_categories</span><span class="p">(</span><span class="n">new_categories</span><span class="p">,</span>
                                                                <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">rename_categories</span><span class="p">(</span><span class="n">new_categories</span><span class="p">,</span>
                                                              <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.rename_series"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.rename_series">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">rename_features</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">rename_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_categories</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">list</span><span class="p">]):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Series are getting renamed to Stack/features.&#39;</span>
                      <span class="s1">&#39;Please use rename_features instead&#39;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rename_features</span><span class="p">(</span><span class="n">new_categories</span><span class="p">)</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.modify_order_features"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.modify_order_features">[docs]</a>    <span class="k">def</span> <span class="nf">modify_order_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Modify order of the feature. Reorder categories of the link Surfaces, sort surface (reset the basement layer)</span>
<span class="sd">        remap the Stack and Surfaces to the corespondent dataframes, sort Geometric objects, update structure and</span>
<span class="sd">        reset the flow control objects.</span>

<span class="sd">        Args:</span>
<span class="sd">            new_value (int): New location</span>
<span class="sd">            idx (str): name of the feature to be moved</span>

<span class="sd">        Returns:</span>
<span class="sd">            :class:`gempy.core.data_modules.stack.Stack`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">modify_order_series</span><span class="p">(</span><span class="n">new_value</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">reorder_categories</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
            <span class="n">ordered</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">sort_surfaces</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">set_basement</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">map_geometric_data_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">sort_table</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map_geometric_data_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">sort_table</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_flow_control</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_structure</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.modify_order_series"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.modify_order_series">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">Series</span><span class="o">.</span><span class="n">modify_order_series</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">modify_order_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Series are getting renamed to Stack/features.&#39;</span>
                      <span class="s1">&#39;Please use modify_order_features instead&#39;</span><span class="p">,</span>
                      <span class="ne">DeprecationWarning</span><span class="p">,</span> <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_order_features</span><span class="p">(</span><span class="n">new_value</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.reorder_features"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.reorder_features">[docs]</a>    <span class="k">def</span> <span class="nf">reorder_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_categories</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Reorder series. Reorder categories of the link Surfaces, sort surface (reset the basement layer)</span>
<span class="sd">        remap the Series and Surfaces to the corespondent dataframes, sort Geometric objects, update structure and</span>
<span class="sd">        reset the flow control objects.</span>

<span class="sd">        Args:</span>
<span class="sd">           new_categories (list): list with all series names in the desired order.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :class:`gempy.core.data_modules.stack.Stack`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">reorder_series</span><span class="p">(</span><span class="n">new_categories</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">reorder_categories</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
            <span class="n">ordered</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">sort_surfaces</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">set_basement</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">map_geometric_data_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">sort_table</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map_geometric_data_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">sort_table</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_flow_control</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_structure</span><span class="p">(</span><span class="n">update_theano</span><span class="o">=</span><span class="s1">&#39;weights&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.reorder_series"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.reorder_series">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">reorder_features</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">reorder_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_categories</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Series are getting renamed to Stack/features.&#39;</span>
                      <span class="s1">&#39;Please use reorder_features instead&#39;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reorder_features</span><span class="p">(</span><span class="n">new_categories</span><span class="p">)</span></div>

    <span class="c1"># endregion</span>

    <span class="c1"># region Faults</span>
<div class="viewcode-block" id="ImplicitCoKriging.set_fault_object"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_fault_object">[docs]</a>    <span class="k">def</span> <span class="nf">set_fault_object</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Not implemented&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.set_is_fault"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_is_fault">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">([</span><span class="n">Faults</span><span class="o">.</span><span class="n">set_is_fault</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">set_is_fault</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feature_fault</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">toggle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                     <span class="n">change_color</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">twofins</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a feature to fault and update all dependent objects of the Model.</span>

<span class="sd">        Args:</span>

<span class="sd">            feature_fault(str, list[str]): Name of the series which are faults</span>
<span class="sd">            toggle (bool): if True, passing a name which is already True will set it False.</span>
<span class="sd">            twofins (bool): If True, it allows to set several surfaces of a given geological feature to fault.</span>
<span class="sd">             This is behaviour is not tested and could have unexpected behaviour.</span>
<span class="sd">            change_color (bool): If True faults surfaces get the default fault color (light gray)</span>

<span class="sd">        Returns:</span>
<span class="sd">            :class:`gempy.core.data_modules.stack.Faults`</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`gempy.core.data_modules.stack.Faults.set_is_fault`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">feature_fault</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">feature_fault</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">twofins</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">fault</span> <span class="ow">in</span> <span class="n">feature_fault</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">aux_assert</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;isBasement&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="kc">False</span><span class="p">)[</span>
                                <span class="s1">&#39;series&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">fault</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">aux_assert</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">aux_assert</span> <span class="o">=</span> <span class="kc">False</span>

                <span class="k">assert</span> <span class="n">aux_assert</span><span class="p">,</span> \
                    <span class="s1">&#39;Having more than one fault in a series is generally rather bad. Better go&#39;</span> \
                    <span class="s1">&#39; back to the function map_series_to_surfaces and give each fault its own&#39;</span> \
                    <span class="s1">&#39; series. If you are really sure what you are doing, you can set twofins to&#39;</span> \
                    <span class="s1">&#39; True to suppress this error.&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_faults</span><span class="o">.</span><span class="n">set_is_fault</span><span class="p">(</span><span class="n">feature_fault</span><span class="p">,</span> <span class="n">toggle</span><span class="o">=</span><span class="n">toggle</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">toggle</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">already_fault</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                                <span class="n">feature_fault</span><span class="p">,</span> <span class="s1">&#39;BottomRelation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Fault&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                <span class="n">feature_fault</span><span class="p">[</span><span class="n">already_fault</span><span class="p">],</span> <span class="s1">&#39;BottomRelation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Erosion&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                <span class="n">feature_fault</span><span class="p">[</span><span class="o">~</span><span class="n">already_fault</span><span class="p">],</span> <span class="s1">&#39;BottomRelation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Fault&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">feature_fault</span><span class="p">,</span> <span class="s1">&#39;BottomRelation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Fault&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">structure_data</span><span class="o">.</span><span class="n">set_number_of_faults</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_theano_shared_relations</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_theano_shared_loop</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">change_color</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s1">&#39;Fault colors changed. If you do not like this behavior, set change_color to False.&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">make_faults_black</span><span class="p">(</span><span class="n">feature_fault</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_from_series</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_structure</span><span class="p">(</span><span class="n">update_theano</span><span class="o">=</span><span class="s1">&#39;matrices&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_faults</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.set_is_finite_fault"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_is_finite_fault">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">([</span><span class="n">Faults</span><span class="o">.</span><span class="n">set_is_finite_fault</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">set_is_finite_fault</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">series_fault</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">toggle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;&quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_faults</span><span class="o">.</span><span class="n">set_is_finite_fault</span><span class="p">(</span><span class="n">series_fault</span><span class="p">,</span>
                                             <span class="n">toggle</span><span class="p">)</span>  <span class="c1"># change df in Fault obj</span>
        <span class="c1"># change shared theano variable for infinite factor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_theano_shared_is_finite</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">s</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.set_fault_relation"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_fault_relation">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">([</span><span class="n">Faults</span><span class="o">.</span><span class="n">set_fault_relation</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">set_fault_relation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rel_matrix</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_faults</span><span class="o">.</span><span class="n">set_fault_relation</span><span class="p">(</span><span class="n">rel_matrix</span><span class="p">)</span>

        <span class="c1"># Updating</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_theano_shared_fault_relation</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_theano_shared_weights</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_faults</span><span class="o">.</span><span class="n">faults_relations_df</span></div>

    <span class="c1"># endregion</span>

    <span class="c1"># region Surfaces</span>
<div class="viewcode-block" id="ImplicitCoKriging.set_surfaces_object"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_surfaces_object">[docs]</a>    <span class="k">def</span> <span class="nf">set_surfaces_object</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Not implemented yet. Exchange the surface object of the Model object</span>
<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.add_surfaces"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_surfaces">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">Surfaces</span><span class="o">.</span><span class="n">add_surface</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">add_surfaces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">surface_list</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span> <span class="n">update_df</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">add_surface</span><span class="p">(</span><span class="n">surface_list</span><span class="p">,</span> <span class="n">update_df</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="n">surface_list</span><span class="p">,</span>
                                                              <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="n">surface_list</span><span class="p">,</span>
                                                            <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_structure</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.delete_surfaces"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.delete_surfaces">[docs]</a>    <span class="nd">@_setdoc_pro</span><span class="p">([</span><span class="n">Surfaces</span><span class="o">.</span><span class="n">update_id</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">delete_surfaces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">update_id</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">remove_data</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        @TODO When implemeted activate geometric data, change remove data to False by default</span>
<span class="sd">        Delete a surface and update all related object.</span>

<span class="sd">        Args:</span>
<span class="sd">            indices (str, list): name or list of names of the series to apply the functionality</span>
<span class="sd">            update_id (bool): if true [s0]</span>
<span class="sd">            remove_data (bool): if true delete all GeometricData labeled with the given surface.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :class:`gempy.core.data.Surfaces`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">delete_surface</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">update_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">indices</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">surfaces_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">indices</span><span class="p">,</span> <span class="s1">&#39;surface&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">surfaces_names</span> <span class="o">=</span> <span class="n">indices</span>

        <span class="k">if</span> <span class="n">remove_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">del_surface_points</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="p">[</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">surface</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">surfaces_names</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">del_orientation</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">df</span><span class="p">[</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">surface</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">surfaces_names</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">remove_categories</span><span class="p">(</span><span class="n">surfaces_names</span><span class="p">,</span>
                                                                 <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">remove_categories</span><span class="p">(</span><span class="n">surfaces_names</span><span class="p">,</span>
                                                               <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map_geometric_data_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map_geometric_data_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">delete_colors</span><span class="p">(</span><span class="n">surfaces_names</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">remove_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_structure</span><span class="p">(</span><span class="n">update_theano</span><span class="o">=</span><span class="s1">&#39;matrices&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_structure</span><span class="p">(</span><span class="n">update_theano</span><span class="o">=</span><span class="s1">&#39;weights&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.rename_surfaces"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.rename_surfaces">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">Surfaces</span><span class="o">.</span><span class="n">rename_surfaces</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">rename_surfaces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_replace</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">rename_surfaces</span><span class="p">(</span><span class="n">to_replace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">rename_categories</span><span class="p">(</span><span class="n">to_replace</span><span class="p">,</span>
                                                                 <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">rename_categories</span><span class="p">(</span><span class="n">to_replace</span><span class="p">,</span>
                                                               <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.modify_order_surfaces"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.modify_order_surfaces">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">Surfaces</span><span class="o">.</span><span class="n">modify_order_surfaces</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">modify_order_surfaces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                              <span class="n">series_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">modify_order_surfaces</span><span class="p">(</span><span class="n">new_value</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">series_name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">map_geometric_data_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">sort_table</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map_geometric_data_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">sort_table</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_structure</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.add_surface_values"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_surface_values">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">Surfaces</span><span class="o">.</span><span class="n">add_surfaces_values</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">add_surface_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values_array</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span>
                           <span class="n">properties_names</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">add_surfaces_values</span><span class="p">(</span><span class="n">values_array</span><span class="p">,</span> <span class="n">properties_names</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_structure</span><span class="p">(</span><span class="n">update_theano</span><span class="o">=</span><span class="s1">&#39;matrices&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.delete_surface_values"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.delete_surface_values">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">Surfaces</span><span class="o">.</span><span class="n">delete_surface_values</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">delete_surface_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">properties_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete_surface_values</span><span class="p">(</span><span class="n">properties_names</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.modify_surface_values"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.modify_surface_values">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">Surfaces</span><span class="o">.</span><span class="n">modify_surface_values</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">modify_surface_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">properties_names</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">modify_surface_values</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">properties_names</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.set_surface_values"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_surface_values">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">Surfaces</span><span class="o">.</span><span class="n">set_surfaces_values</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">set_surface_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values_array</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span>
                           <span class="n">properties_names</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">set_surfaces_values</span><span class="p">(</span><span class="n">values_array</span><span class="p">,</span> <span class="n">properties_names</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.map_stack_to_surfaces"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.map_stack_to_surfaces">[docs]</a>    <span class="k">def</span> <span class="nf">map_stack_to_surfaces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                              <span class="n">mapping_object</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="n">pn</span><span class="o">.</span><span class="n">Categorical</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                              <span class="n">set_series</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_geometric_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                              <span class="n">remove_unused_series</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">twofins</span><span class="o">=</span><span class="kc">False</span>
                              <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Map series to surfaces and update all related objects accordingly to the following arguments:</span>

<span class="sd">        Args:</span>
<span class="sd">            mapping_object (dict, :class:`pandas.DataFrame`):</span>

<span class="sd">                * dict: keys are the series and values the surfaces belonging to that series</span>

<span class="sd">                * pandas.DataFrame: Dataframe with surfaces as index and a column series with the correspondent series</span>
<span class="sd">                  name of each surface</span>

<span class="sd">            set_series (bool): if True, if mapping object has non existing series they will be created.</span>
<span class="sd">            sort_geometric_data (bool): If true geometric data will be sorted accordingly to the new order of the</span>
<span class="sd">             series</span>
<span class="sd">            remove_unused_series (bool): if true, if an existing series is not assigned with a surface, it will get</span>
<span class="sd">             removed from the Series object.</span>
<span class="sd">            twofins (bool): If True, it allows to set several surfaces of a given geological feature to fault.</span>
<span class="sd">             This is behaviour is not tested and could have unexpected behaviour.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :class:`gempy.core.data.Surfaces`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Add New series to the series df</span>
        <span class="k">if</span> <span class="n">set_series</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mapping_object</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
                <span class="n">series_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mapping_object</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="n">series_list</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mapping_object</span><span class="p">,</span> <span class="n">pn</span><span class="o">.</span><span class="n">Categorical</span><span class="p">):</span>
                <span class="n">series_list</span> <span class="o">=</span> <span class="n">mapping_object</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="n">series_list</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                    <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">mapping_object</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; is not the right attribute type.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">map_series</span><span class="p">(</span><span class="n">mapping_object</span><span class="p">)</span>

        <span class="c1"># Here we remove the series that were not assigned to a surface</span>
        <span class="k">if</span> <span class="n">remove_unused_series</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">remove_unused_categories</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">unused_cat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">delete_series</span><span class="p">(</span><span class="n">unused_cat</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">reset_order_series</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_from_surfaces</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_from_series</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">sort_geometric_data</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">sort_table</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">sort_table</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">set_series</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;Basement&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">aux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Basement&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">array</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reorder_features</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aux</span><span class="p">,</span> <span class="s1">&#39;Basement&#39;</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">twofins</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>  <span class="c1"># assert if every fault has its own series</span>
            <span class="k">for</span> <span class="n">serie</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_faults</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_faults</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;isFault&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
                <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">serie</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">,</span> \
                    <span class="s1">&#39;Having more than one fault in a series is generally rather bad. Better give each &#39;</span> \
                    <span class="s1">&#39;fault its own series. If you are really sure what you are doing, you can set &#39;</span> \
                    <span class="s1">&#39;twofins to True to suppress this error.&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_structure</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">surfaces</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.map_series_to_surfaces"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.map_series_to_surfaces">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">map_stack_to_surfaces</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">map_series_to_surfaces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_stack_to_surfaces</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="c1"># endregion</span>

    <span class="c1"># region Surface_points</span>

<div class="viewcode-block" id="ImplicitCoKriging.set_surface_points_object"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_surface_points_object">[docs]</a>    <span class="k">def</span> <span class="nf">set_surface_points_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">surface_points</span><span class="p">:</span> <span class="n">SurfacePoints</span><span class="p">,</span>
                                  <span class="n">update_model</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Not Implemented&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_check_possible_column_names</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">possible_candidates</span><span class="p">):</span>
        <span class="n">possible_candidates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">possible_candidates</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">possible_candidates</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">possible_candidates</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>

<div class="viewcode-block" id="ImplicitCoKriging.set_surface_points"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_surface_points">[docs]</a>    <span class="nd">@_setdoc_pro</span><span class="p">(</span><span class="n">SurfacePoints</span><span class="o">.</span><span class="n">set_surface_points</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">set_surface_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">pn</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set coordinates and surface columns on the df.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (pandas.Dataframe): table with surface points data.</span>

<span class="sd">        Keyword Args:</span>
<span class="sd">            bool add_basement: add a basement surface to the df.</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`gempy.core.data_modules.geometric_data.SurfacePoints`</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">coord_x_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;coord_x_name&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="s1">&#39;coord_x_name&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> \
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_possible_column_names</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">])</span>
        <span class="n">coord_y_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;coord_y_name&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="s1">&#39;coord_y_name&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> \
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_possible_column_names</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
        <span class="n">coord_z_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;coord_z_name&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="s1">&#39;coord_z_name&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> \
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_possible_column_names</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">])</span>
        <span class="n">surface_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;surface_name&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="s1">&#39;surface_name&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> \
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_possible_column_names</span><span class="p">(</span><span class="n">table</span><span class="p">,</span>
                                                   <span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">,</span> <span class="s1">&#39;Surface&#39;</span><span class="p">,</span> <span class="s1">&#39;surfaces&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;surfaces&#39;</span><span class="p">,</span> <span class="s1">&#39;formations&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;formation&#39;</span><span class="p">])</span>
        <span class="n">update_surfaces</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;update_surfaces&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">update_surfaces</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_surfaces</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="n">surface_name</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">_columns_i_1</span><span class="p">)</span>
        <span class="n">surface_points_table</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
            <span class="o">**</span><span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">in1d</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">)],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">set_surface_points</span><span class="p">(</span>
            <span class="n">surface_points_table</span><span class="p">[[</span><span class="n">coord_x_name</span><span class="p">,</span> <span class="n">coord_y_name</span><span class="p">,</span> <span class="n">coord_z_name</span><span class="p">]],</span>
            <span class="n">surface</span><span class="o">=</span><span class="n">surface_points_table</span><span class="p">[</span><span class="n">surface_name</span><span class="p">])</span>

        <span class="k">if</span> <span class="s1">&#39;add_basement&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;add_basement&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">add_surface</span><span class="p">([</span><span class="s1">&#39;basement&#39;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">map_stack_to_surfaces</span><span class="p">({</span><span class="s1">&#39;Basement&#39;</span><span class="p">:</span> <span class="s1">&#39;basement&#39;</span><span class="p">},</span> <span class="n">set_series</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">map_geometric_data_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rescaling</span><span class="o">.</span><span class="n">rescale_data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_structure</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.set_orientations"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_orientations">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">Orientations</span><span class="o">.</span><span class="n">set_orientations</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;beg&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">set_orientations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">pn</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Set coordinates, surface and orientation data.</span>

<span class="sd">        If both are passed pole vector has priority over orientation</span>

<span class="sd">        Args:</span>
<span class="sd">            table (pn.Dataframe): table with surface points data.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :class:`gempy.core.data_modules.geometric_data.Orientations`</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`gempy.core.data_modules.geometric_data.Orientations`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">g_x_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;G_x_name&#39;</span><span class="p">,</span> <span class="s1">&#39;G_x&#39;</span><span class="p">)</span>
        <span class="n">g_y_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;G_y_name&#39;</span><span class="p">,</span> <span class="s1">&#39;G_y&#39;</span><span class="p">)</span>
        <span class="n">g_z_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;G_z_name&#39;</span><span class="p">,</span> <span class="s1">&#39;G_z&#39;</span><span class="p">)</span>
        <span class="n">azimuth_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;azimuth_name&#39;</span><span class="p">,</span> <span class="s1">&#39;azimuth&#39;</span><span class="p">)</span>
        <span class="n">dip_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dip_name&#39;</span><span class="p">,</span> <span class="s1">&#39;dip&#39;</span><span class="p">)</span>
        <span class="n">polarity_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;polarity_name&#39;</span><span class="p">,</span> <span class="s1">&#39;polarity&#39;</span><span class="p">)</span>
        <span class="n">update_surfaces</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;update_surfaces&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="n">coord_x_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;coord_x_name&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="s1">&#39;coord_x_name&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> \
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_possible_column_names</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">])</span>
        <span class="n">coord_y_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;coord_y_name&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="s1">&#39;coord_y_name&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> \
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_possible_column_names</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
        <span class="n">coord_z_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;coord_z_name&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="s1">&#39;coord_z_name&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> \
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_possible_column_names</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">])</span>
        <span class="n">surface_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;surface_name&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="s1">&#39;surface_name&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> \
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_possible_column_names</span><span class="p">(</span><span class="n">table</span><span class="p">,</span>
                                                   <span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">,</span> <span class="s1">&#39;Surface&#39;</span><span class="p">,</span> <span class="s1">&#39;surfaces&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;surfaces&#39;</span><span class="p">,</span> <span class="s1">&#39;formations&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;formation&#39;</span><span class="p">,</span> <span class="s1">&#39;Formation&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">update_surfaces</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_surfaces</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="n">surface_name</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">_columns_o_1</span><span class="p">)</span>
        <span class="n">orientations_read</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
            <span class="o">**</span><span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">in1d</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">)],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">set_orientations</span><span class="p">(</span>
            <span class="n">coord</span><span class="o">=</span><span class="n">orientations_read</span><span class="p">[[</span><span class="n">coord_x_name</span><span class="p">,</span> <span class="n">coord_y_name</span><span class="p">,</span> <span class="n">coord_z_name</span><span class="p">]],</span>
            <span class="n">pole_vector</span><span class="o">=</span><span class="n">orientations_read</span><span class="p">[[</span><span class="n">g_x_name</span><span class="p">,</span> <span class="n">g_y_name</span><span class="p">,</span> <span class="n">g_z_name</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
            <span class="n">orientation</span><span class="o">=</span><span class="n">orientations_read</span><span class="p">[</span>
                <span class="p">[</span><span class="n">azimuth_name</span><span class="p">,</span> <span class="n">dip_name</span><span class="p">,</span> <span class="n">polarity_name</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
            <span class="n">surface</span><span class="o">=</span><span class="n">orientations_read</span><span class="p">[</span><span class="n">surface_name</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">map_geometric_data_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rescaling</span><span class="o">.</span><span class="n">rescale_data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_structure</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.add_surface_points"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_surface_points">[docs]</a>    <span class="nd">@_setdoc_pro</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">recompute_rf</span><span class="p">)</span>
    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">SurfacePoints</span><span class="o">.</span><span class="n">add_surface_points</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;beg&#39;</span><span class="p">)</span>
    <span class="nd">@plot_add_surface_points</span>
    <span class="k">def</span> <span class="nf">add_surface_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">surface</span><span class="p">,</span>
                           <span class="n">idx</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                           <span class="n">recompute_rescale_factor</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            X:</span>
<span class="sd">            Y:</span>
<span class="sd">            Z:</span>
<span class="sd">            surface (str):</span>
<span class="sd">            idx: Index of the point. If None, next available index will be used</span>
<span class="sd">            recompute_rescale_factor (bool): [s0].</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">surface</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">surface</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_valid_idx_s</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">add_surface_points</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">surface</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">recompute_rescale_factor</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">:</span>
            <span class="c1"># This will rescale all data again</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rescaling</span><span class="o">.</span><span class="n">rescale_data</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_theano_shared_kriging</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># This branch only recompute the added point</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rescaling</span><span class="o">.</span><span class="n">set_rescaled_surface_points</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_structure</span><span class="p">(</span><span class="n">update_theano</span><span class="o">=</span><span class="s1">&#39;matrices&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_theano_shared_nuggets</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="p">,</span> <span class="n">idx</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.delete_surface_points"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.delete_surface_points">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">SurfacePoints</span><span class="o">.</span><span class="n">del_surface_points</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;beg&#39;</span><span class="p">)</span>
    <span class="nd">@plot_delete_surface_points</span>
    <span class="k">def</span> <span class="nf">delete_surface_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">del_surface_points</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_structure</span><span class="p">(</span><span class="n">update_theano</span><span class="o">=</span><span class="s1">&#39;matrices&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.delete_surface_points_basement"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.delete_surface_points_basement">[docs]</a>    <span class="k">def</span> <span class="nf">delete_surface_points_basement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete surface points belonging to the basement layer if any&quot;&quot;&quot;</span>

        <span class="n">basement_name</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;isBasement&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">select</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">basement_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete_surface_points</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">select</span><span class="p">])</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.modify_surface_points"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.modify_surface_points">[docs]</a>    <span class="nd">@_setdoc_pro</span><span class="p">()</span>
    <span class="nd">@plot_move_surface_points</span>
    <span class="k">def</span> <span class="nf">modify_surface_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
                              <span class="n">recompute_rescale_factor</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Allows modification of the x,y and/or z-coordinates of an interface at specified dataframe index.</span>

<span class="sd">        Args:</span>
<span class="sd">            indices: [s_idx_sp]</span>
<span class="sd">            recompute_rescale_factor: [s_recompute_rf]</span>

<span class="sd">        Keyword Args:</span>
<span class="sd">                * X: [s_x]</span>

<span class="sd">                * Y: [s_y]</span>

<span class="sd">                * Z: [s_z]</span>

<span class="sd">                * surface: [s_surface_sp]</span>

<span class="sd">         Returns:</span>
<span class="sd">            :class:`gempy.core.data_modules.geometric_data.SurfacePoints`</span>

<span class="sd">         &quot;&quot;&quot;</span>

        <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">is_surface</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="s1">&#39;surface&#39;</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">is_surface</span><span class="p">:</span>
            <span class="k">assert</span> <span class="p">(</span>
                <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;isBasement&#39;</span><span class="p">]][</span><span class="s1">&#39;surface&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">])))</span><span class="o">.</span><span class="n">any</span><span class="p">(),</span> \
                <span class="s1">&#39;Surface points cannot belong to Basement. Add a new surface.&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">modify_surface_points</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">recompute_rescale_factor</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">:</span>
            <span class="c1"># This will rescale all data again</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rescaling</span><span class="o">.</span><span class="n">rescale_data</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_theano_shared_kriging</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># This branch only recompute the added point</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rescaling</span><span class="o">.</span><span class="n">set_rescaled_surface_points</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>

        <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">is_surface</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="s1">&#39;surface&#39;</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">is_surface</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_structure</span><span class="p">(</span><span class="n">update_theano</span><span class="o">=</span><span class="s1">&#39;matrices&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;smooth&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_theano_shared_nuggets</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span></div>

    <span class="c1"># endregion</span>

    <span class="c1"># region Orientation</span>
    <span class="k">def</span> <span class="nf">set_orientations_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orientations</span><span class="p">:</span> <span class="n">Orientations</span><span class="p">,</span> <span class="n">update_model</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

<div class="viewcode-block" id="ImplicitCoKriging.add_orientations"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.add_orientations">[docs]</a>    <span class="nd">@_setdoc_pro</span><span class="p">()</span>
    <span class="nd">@plot_add_orientation</span>
    <span class="k">def</span> <span class="nf">add_orientations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">surface</span><span class="p">,</span> <span class="n">pole_vector</span><span class="p">:</span> <span class="n">Iterable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">orientation</span><span class="p">:</span> <span class="n">Iterable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">recompute_rescale_factor</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add orientation.</span>

<span class="sd">        Args:</span>
<span class="sd">            X: [s_x]</span>
<span class="sd">            Y: [s_y]</span>
<span class="sd">            Z: [s_z]</span>
<span class="sd">            surface: [s_surface_sp]</span>
<span class="sd">            pole_vector: [s_pole_vector]</span>
<span class="sd">            orientation: [s_orientations]</span>
<span class="sd">            idx: [s_idx_sp]</span>
<span class="sd">            recompute_rescale_factor: [s_recompute_rf]</span>

<span class="sd">        Returns:</span>
<span class="sd">            :class:`gempy.core.data_modules.geometric_data.Orientations`</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">surface</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">surface</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_valid_idx_o</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">add_orientation</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">surface</span><span class="p">,</span> <span class="n">pole_vector</span><span class="o">=</span><span class="n">pole_vector</span><span class="p">,</span>
                                           <span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="n">idx</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">recompute_rescale_factor</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="c1"># This will rescale all data again</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rescaling</span><span class="o">.</span><span class="n">rescale_data</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># This branch only recompute the added point</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rescaling</span><span class="o">.</span><span class="n">set_rescaled_orientations</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_structure</span><span class="p">(</span><span class="n">update_theano</span><span class="o">=</span><span class="s1">&#39;weights&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_theano_shared_nuggets</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="p">,</span> <span class="n">idx</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.delete_orientations"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.delete_orientations">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">Orientations</span><span class="o">.</span><span class="n">del_orientation</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;beg&#39;</span><span class="p">)</span>
    <span class="nd">@plot_delete_orientations</span>
    <span class="k">def</span> <span class="nf">delete_orientations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">int</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">del_orientation</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_structure</span><span class="p">(</span><span class="n">update_theano</span><span class="o">=</span><span class="s1">&#39;weights&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.modify_orientations"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.modify_orientations">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">Orientations</span><span class="o">.</span><span class="n">modify_orientations</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;beg&#39;</span><span class="p">)</span>
    <span class="nd">@plot_move_orientations</span>
    <span class="k">def</span> <span class="nf">modify_orientations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">ndmin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">is_surface</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="s1">&#39;surface&#39;</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">modify_orientations</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rescaling</span><span class="o">.</span><span class="n">set_rescaled_orientations</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_surface</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_structure</span><span class="p">(</span><span class="n">update_theano</span><span class="o">=</span><span class="s1">&#39;weights&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;smooth&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_theano_shared_nuggets</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span></div>

    <span class="c1"># endregion</span>

    <span class="c1"># region Options</span>
<div class="viewcode-block" id="ImplicitCoKriging.modify_options"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.modify_options">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">Options</span><span class="o">.</span><span class="n">modify_options</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;beg&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">modify_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">modify_options</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s1">&#39;You need to recompile the Theano code to make it the changes in options.&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">options</span></div>

    <span class="c1"># endregion</span>

    <span class="c1"># region Kriging</span>
<div class="viewcode-block" id="ImplicitCoKriging.modify_kriging_parameters"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.modify_kriging_parameters">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">KrigingParameters</span><span class="o">.</span><span class="n">modify_kriging_parameters</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">position</span><span class="o">=</span><span class="s1">&#39;beg&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">modify_kriging_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">kriging_data</span><span class="o">.</span><span class="n">modify_kriging_parameters</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span>
                                                                     <span class="n">value</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_theano_shared_kriging</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;drift equations&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_initial_results</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_structure</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">kriging_data</span></div>

    <span class="c1"># endregion</span>

    <span class="c1"># region rescaling</span>
<div class="viewcode-block" id="ImplicitCoKriging.modify_rescaling_parameters"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.modify_rescaling_parameters">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">ScalingSystem</span><span class="o">.</span><span class="n">modify_rescaling_parameters</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">position</span><span class="o">=</span><span class="s1">&#39;beg&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">modify_rescaling_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">rescaling_data</span><span class="o">.</span><span class="n">modify_rescaling_parameters</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span>
                                                                         <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">rescaling_data</span><span class="o">.</span><span class="n">rescale_data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">update_default_kriging</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">rescaling_data</span></div>

    <span class="c1"># endregion</span>

    <span class="c1"># ======================================</span>
    <span class="c1"># --------------------------------------</span>
    <span class="c1"># ======================================</span>

<div class="viewcode-block" id="ImplicitCoKriging.set_default_surface_point"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_default_surface_point">[docs]</a>    <span class="k">def</span> <span class="nf">set_default_surface_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set a default surface point if the df is empty. This is necessary for some</span>
<span class="sd">        type of functionality such as qgrid.</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs: Same as :func:`gempy.core.data_modules.geometric_data.SurfacePoints.add_surface_points`</span>

<span class="sd">        Returns:</span>
<span class="sd">            :class:`gempy.core.data_modules.geometric_data.SurfacePoints`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_surface_points</span><span class="p">(</span><span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">,</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                    <span class="n">recompute_rescale_factor</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.set_default_orientation"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_default_orientation">[docs]</a>    <span class="k">def</span> <span class="nf">set_default_orientation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set a default orientation if the df is empty. This is necessary for some type of functionality such as qgrid</span>

<span class="sd">         Args:</span>
<span class="sd">             **kwargs: Same as :func::class:`gempy.core.data_modules.geometric_data.Orientations.add_orientation`</span>

<span class="sd">         Returns:</span>
<span class="sd">             :class:`gempy.core.data_modules.geometric_data.Orientations`</span>

<span class="sd">         &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># TODO DEBUG: I am not sure that surfaces always has at least one entry. Check it</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_orientations</span><span class="p">(</span><span class="o">.</span><span class="mi">00001</span><span class="p">,</span> <span class="o">.</span><span class="mi">00001</span><span class="p">,</span> <span class="o">.</span><span class="mi">00001</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">recompute_rescale_factor</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.set_default_surfaces"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_default_surfaces">[docs]</a>    <span class="k">def</span> <span class="nf">set_default_surfaces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set two default surfaces if the df is empty. This is necessary for some type of functionality such as qgrid</span>

<span class="sd">         Returns:</span>
<span class="sd">             :class:`gempy.core.data.Surfaces`</span>

<span class="sd">         &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delete_surfaces</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_surfaces</span><span class="p">([</span><span class="s1">&#39;surface1&#39;</span><span class="p">,</span> <span class="s1">&#39;surface2&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_from_surfaces</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.set_extent"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_extent">[docs]</a>    <span class="nd">@_setdoc_pro</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">set_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extent</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set project extent</span>

<span class="sd">        Args:</span>
<span class="sd">            extent: [s_extent]</span>

<span class="sd">        Returns:</span>
<span class="sd">            :class:`gempy.core.data.Grid`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">extent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">extent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">extent</span> <span class="o">=</span> <span class="n">extent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rescaling</span><span class="o">.</span><span class="n">set_rescaled_grid</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.update_from_series"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.update_from_series">[docs]</a>    <span class="k">def</span> <span class="nf">update_from_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reorder_series</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_geometric_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">update_interpolator</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update all objects dependent on series.</span>

<span class="sd">        This method is a bit of a legacy and has been substituted by :meth:`rename_series` and :meth:`reorder_series`,</span>
<span class="sd">        however is useful if you want to make sure all objects are up to date with the latest changes on series.</span>

<span class="sd">        Args:</span>

<span class="sd">            reorder_series (bool): if True reorder all pandas categories accordingly to the series.df</span>
<span class="sd">            sort_geometric_data (bool): It True sort the geometric data after mapping the new order</span>
<span class="sd">            update_interpolator (bool): If True update the theano shared variables dependent on the structure</span>

<span class="sd">        Returns:</span>
<span class="sd">            True</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">reorder_series</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">reorder_categories</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
                <span class="n">ordered</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">reorder_categories</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
                <span class="n">ordered</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">sort_surfaces</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_from_surfaces</span><span class="p">(</span><span class="n">set_categories_from_series</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                      <span class="n">set_categories_from_surfaces</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">map_surface_points</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                      <span class="n">map_orientations</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                      <span class="n">update_structural_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Update surface is active from series does not work because you can have only a subset of surfaces of a</span>
        <span class="c1"># series active</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;isFault&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_faults</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;isFault&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">set_basement</span><span class="p">()</span>

        <span class="c1"># Add categories from series</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">set_series_categories_from_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">set_series_categories_from_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">map_data_from_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="p">,</span> <span class="s1">&#39;order_series&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">map_data_from_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="p">,</span> <span class="s1">&#39;order_series&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">sort_geometric_data</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">sort_table</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">sort_table</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">update_structure</span><span class="p">()</span>
        <span class="c1"># For the drift equations.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">update_default_kriging</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">update_interpolator</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_theano_shared_structure</span><span class="p">(</span><span class="n">reset_ctrl</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.update_from_surfaces"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.update_from_surfaces">[docs]</a>    <span class="k">def</span> <span class="nf">update_from_surfaces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">set_categories_from_series</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="n">set_categories_from_surfaces</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="n">map_surface_points</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">map_orientations</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="n">update_structural_data</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update all objects dependt on surfaces.</span>

<span class="sd">        Args:</span>
<span class="sd">            set_categories_from_series (bool): If True update the pandas categories with the Series object</span>
<span class="sd">            set_categories_from_surfaces (bool): If True update the pandas categories with the surfaces object</span>
<span class="sd">            map_surface_points (bool): If True map the surface points fields with the Surfaces obejct</span>
<span class="sd">            map_orientations (bool): If True map the orientations fields with the Surfaces object</span>
<span class="sd">            update_structural_data (bool): If true update the Structure with the Surface object</span>

<span class="sd">        Returns:</span>
<span class="sd">            True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Add categories from series</span>
        <span class="k">if</span> <span class="n">set_categories_from_series</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">set_series_categories_from_series</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">set_series_categories_from_series</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>

        <span class="c1"># Add categories from surfaces</span>
        <span class="k">if</span> <span class="n">set_categories_from_surfaces</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">set_surface_categories_from_surfaces</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">set_surface_categories_from_surfaces</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">map_surface_points</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">map_data_from_surfaces</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="p">,</span> <span class="s1">&#39;series&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">map_data_from_surfaces</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">map_orientations</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">map_data_from_surfaces</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="p">,</span> <span class="s1">&#39;series&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">map_data_from_surfaces</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">update_structural_data</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">update_structure</span><span class="p">()</span>

        <span class="k">return</span> <span class="kc">True</span></div>

    <span class="c1"># region Theano interface</span>
<div class="viewcode-block" id="ImplicitCoKriging.set_theano_graph"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_theano_graph">[docs]</a>    <span class="nd">@_setdoc</span><span class="p">(</span><span class="n">InterpolatorModel</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">set_theano_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interpolator</span><span class="p">:</span> <span class="n">InterpolatorModel</span><span class="p">,</span>
                         <span class="n">update_structure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">update_kriging</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Pass a theano graph of a Interpolator instance other than the Model compose</span>

<span class="sd">        Use this method only if you know what are you doing!</span>

<span class="sd">        Args:</span>
<span class="sd">            interpolator (:class:`InterpolatorModel`): [s0]</span>

<span class="sd">        Returns:</span>
<span class="sd">             True &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s1">&#39;This function is going to be deprecated. Use Model.set_theano_function instead&#39;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">theano_graph</span> <span class="o">=</span> <span class="n">interpolator</span><span class="o">.</span><span class="n">theano_graph</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">theano_function</span> <span class="o">=</span> <span class="n">interpolator</span><span class="o">.</span><span class="n">theano_function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_additional_data</span><span class="p">(</span><span class="n">update_structure</span><span class="o">=</span><span class="n">update_structure</span><span class="p">,</span>
                                    <span class="n">update_kriging</span><span class="o">=</span><span class="n">update_kriging</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_to_interpolator</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span></div>

    <span class="c1"># @_setdoc(InterpolatorModel.__doc__)</span>
<div class="viewcode-block" id="ImplicitCoKriging.set_theano_function"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_theano_function">[docs]</a>    <span class="k">def</span> <span class="nf">set_theano_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interpolator</span><span class="p">:</span> <span class="n">InterpolatorModel</span><span class="p">,</span>
                            <span class="n">update_structure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">update_kriging</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Pass a theano function and its correspondent graph from an Interpolator</span>
<span class="sd">         instance other than the Model compose</span>

<span class="sd">        Args:</span>
<span class="sd">            interpolator (:class:`gempy.core.interpolator.InterpolatorModel`): interpolator object</span>
<span class="sd">             with the compile graph.</span>
<span class="sd">            update_kriging (bool): if True update kriging parameters</span>
<span class="sd">            update_structure (bool): if Ture update structure</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`gempy.core.interpolator.InterpolatorModel`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">theano_graph</span> <span class="o">=</span> <span class="n">interpolator</span><span class="o">.</span><span class="n">theano_graph</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">theano_function</span> <span class="o">=</span> <span class="n">interpolator</span><span class="o">.</span><span class="n">theano_function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_additional_data</span><span class="p">(</span><span class="n">update_structure</span><span class="o">=</span><span class="n">update_structure</span><span class="p">,</span>
                                    <span class="n">update_kriging</span><span class="o">=</span><span class="n">update_kriging</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_to_interpolator</span><span class="p">()</span>

        <span class="k">return</span> <span class="kc">True</span></div>

    <span class="k">def</span> <span class="nf">update_additional_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update_structure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">update_kriging</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">update_structure</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_structure</span><span class="p">(</span><span class="n">update_theano</span><span class="o">=</span><span class="s1">&#39;matrices&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">update_kriging</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Setting kriging parameters to their default values.&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">update_default_kriging</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span>

<div class="viewcode-block" id="ImplicitCoKriging.update_to_interpolator"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.update_to_interpolator">[docs]</a>    <span class="k">def</span> <span class="nf">update_to_interpolator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update all shared parameters from the data objects</span>

<span class="sd">        Args:</span>
<span class="sd">            reset (bool): if True reset the flow control and initialize results arrays</span>

<span class="sd">        Returns:</span>
<span class="sd">            True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">set_all_shared_parameters</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">reset</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">reset_flow_control_initial_results</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span></div>

    <span class="c1"># endregion</span>

<div class="viewcode-block" id="ImplicitCoKriging.map_geometric_data_df"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.map_geometric_data_df">[docs]</a>    <span class="k">def</span> <span class="nf">map_geometric_data_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">pn</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Map a geometric data dataframe from the linked objects (at 07.2019 surfaces and series)</span>

<span class="sd">        Args:</span>
<span class="sd">            d (pn.DataFrame): Geometric data dataframe to be mapped</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;surface&#39;</span><span class="p">)[</span><span class="s1">&#39;series&#39;</span><span class="p">])</span>
        <span class="n">d</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;surface&#39;</span><span class="p">)[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">d</span><span class="p">[</span><span class="s1">&#39;order_series&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;order_series&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">d</span></div>

<div class="viewcode-block" id="ImplicitCoKriging.set_surface_order_from_solution"><a class="viewcode-back" href="../../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.set_surface_order_from_solution">[docs]</a>    <span class="k">def</span> <span class="nf">set_surface_order_from_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Order the surfaces respect the last computation. Therefore if you call this method,</span>
<span class="sd">        after sorting surface_points without recomputing you may get wrong results.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Surfaces</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">sfai_order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">scalar_field_at_surface_points</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1"># Check if the order has changed</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">sfai_order</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sfai_order_0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sfai_order_0</span> <span class="o">=</span> <span class="n">sfai_order</span>
            <span class="n">sel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;isActive&#39;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;isBasement&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sel</span><span class="p">,</span> <span class="s1">&#39;sfai&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sfai_order</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">,</span> <span class="s1">&#39;sfai&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                          <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">reset_order_surfaces</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">sort_surfaces</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">set_basement</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;surface&#39;</span><span class="p">)[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;surface&#39;</span><span class="p">)[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">sort_table</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">sort_table</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_structure</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span></div></div>


<span class="k">def</span> <span class="nf">Model</span><span class="p">(</span><span class="n">project_name</span><span class="o">=</span><span class="s1">&#39;default_project&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Container class of all objects that constitute a GemPy model.</span>

<span class="sd">      In addition the class provides the methods that act in more than one of this class. Model is a child class of</span>
<span class="sd">      :class:`DataMutation` and :class:`MetaData`.</span>

<span class="sd">      &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;This C;ass is going to be deprecated in GemPy 2.3. &#39;</span>
                  <span class="s1">&#39;Use Project instead.&#39;</span><span class="p">,</span>
                  <span class="ne">DeprecationWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Project</span><span class="p">(</span><span class="n">project_name</span><span class="p">)</span>


<div class="viewcode-block" id="Project"><a class="viewcode-back" href="../../../Model/gempy.core.model.Project.html#gempy.core.model.Project">[docs]</a><span class="k">class</span> <span class="nc">Project</span><span class="p">(</span><span class="n">ImplicitCoKriging</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Container class of all objects that constitute a GemPy model.</span>

<span class="sd">    In addition the class provides all the methods you need to construct a geological</span>
<span class="sd">    model with :class:`ImplicitCoKriging`.</span>

<span class="sd">    See Also:</span>
<span class="sd">        :class:`MetaData`, :class:`ImplicitCoKriging`</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Project.__init__"><a class="viewcode-back" href="../../../Model/gempy.core.model.Project.html#gempy.core.model.Project.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_name</span><span class="o">=</span><span class="s1">&#39;default_project&#39;</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span> <span class="o">=</span> <span class="n">MetaData</span><span class="p">(</span><span class="n">project_name</span><span class="o">=</span><span class="n">project_name</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">project_name</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">date</span>

<div class="viewcode-block" id="Project.new_model"><a class="viewcode-back" href="../../../Model/gempy.core.model.Project.html#gempy.core.model.Project.new_model">[docs]</a>    <span class="k">def</span> <span class="nf">new_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name_project</span><span class="o">=</span><span class="s1">&#39;default_project&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reset the model object.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name_project</span><span class="p">)</span></div>

<div class="viewcode-block" id="Project.save_model_pickle"><a class="viewcode-back" href="../../../Model/gempy.core.model.Project.html#gempy.core.model.Project.save_model_pickle">[docs]</a>    <span class="k">def</span> <span class="nf">save_model_pickle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Short term model storage. Object to a python pickle (serialization of python). Be aware that if the dependencies</span>
<span class="sd">        versions used to export and import the pickle differ it may give problems</span>

<span class="sd">        Args:</span>
<span class="sd">            path (str): path where save the pickle</span>

<span class="sd">        Returns:</span>
<span class="sd">            True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Deleting qi attribute otherwise doesnt allow to pickle</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;qi&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="fm">__delattr__</span><span class="p">(</span><span class="s1">&#39;qi&#39;</span><span class="p">)</span>

        <span class="n">sys</span><span class="o">.</span><span class="n">setrecursionlimit</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;./&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">project_name</span>
        <span class="kn">import</span> <span class="nn">pickle</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;.pickle&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="c1"># Pickle the &#39;data&#39; dictionary using the highest protocol available.</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">pickle</span><span class="o">.</span><span class="n">HIGHEST_PROTOCOL</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Project.load_model_pickle"><a class="viewcode-back" href="../../../Model/gempy.core.model.Project.html#gempy.core.model.Project.load_model_pickle">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">load_model_pickle</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read InputData object from python pickle.</span>

<span class="sd">        Args:</span>
<span class="sd">           path (str): path where save the pickle</span>

<span class="sd">        Returns:</span>
<span class="sd">            :class:`gempy.core.model.Model`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">pickle</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="c1"># The protocol version used is detected automatically, so we do not</span>
            <span class="c1"># have to specify it.</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">model</span></div>

<div class="viewcode-block" id="Project.save_model"><a class="viewcode-back" href="../../../Model/gempy.core.model.Project.html#gempy.core.model.Project.save_model">[docs]</a>    <span class="k">def</span> <span class="nf">save_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">compress</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save model in new folder. Input data is saved as csv files. Solutions, extent and resolutions are saved as npy.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): name of the newly created folder and the part of the files name</span>
<span class="sd">            path (str): path where save the model folder.</span>
<span class="sd">            compress (bool): If true create a zip</span>

<span class="sd">        Returns:</span>
<span class="sd">            True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">gempy.api_modules.io</span> <span class="kn">import</span> <span class="n">default_path_and_name</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="n">default_path_and_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>

        <span class="c1"># save dataframes as csv</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_surface_points.csv&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_surfaces.csv&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_orientations.csv&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_series.csv&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_faults</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_faults.csv&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_faults</span><span class="o">.</span><span class="n">faults_relations_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_faults_relations.csv&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">kriging_data</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_kriging_data.csv&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">rescaling_data</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_rescaling_data.csv&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_options.csv&#39;</span><span class="p">)</span>

        <span class="c1"># # save resolution and extent as npy</span>
        <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_extent.npy&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">regular_grid</span><span class="o">.</span><span class="n">extent</span><span class="p">)</span>
        <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_resolution.npy&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">regular_grid</span><span class="o">.</span><span class="n">resolution</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">topography</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">topography</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_topography.npy&#39;</span><span class="p">)</span>

        <span class="c1"># if compress is True:</span>
        <span class="c1">#     shutil.make_archive(name, &#39;zip&#39;, path)</span>
        <span class="c1">#     shutil.rmtree(path)</span>
        <span class="k">return</span> <span class="kc">True</span></div>

    <span class="k">def</span> <span class="nf">save_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<div class="viewcode-block" id="Project.read_data"><a class="viewcode-back" href="../../../Model/gempy.core.model.Project.html#gempy.core.model.Project.read_data">[docs]</a>    <span class="k">def</span> <span class="nf">read_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_i</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source_o</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">add_basement</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read data from a csv, or directly supplied dataframes</span>

<span class="sd">        Args:</span>
<span class="sd">            source_i: Path to the data bases of surface_points. Default os.getcwd(), or direct pandas data frame</span>
<span class="sd">            source_o: Path to the data bases of orientations. Default os.getcwd(), or direct pandas data frame</span>
<span class="sd">            add_basement (bool): if True add a basement surface. This wont be interpolated it just gives the values</span>
<span class="sd">            for the volume below the last surface.</span>

<span class="sd">        Keyword Args:</span>
<span class="sd">            update_surfaces (bool): True</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True</span>

<span class="sd">        See Also:</span>

<span class="sd">            * :class:`gempy.core.data_modules.geometric_data.SurfacePoints.read_surface_points.`</span>

<span class="sd">            * :class:`gempy.core.data_modules.geometric_data.Orientations.read_orientations`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;update_surfaces&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;update_surfaces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;path_i&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">source_i</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;path_i&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;path_o&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">source_o</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;path_o&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source_i</span><span class="p">,</span> <span class="n">pn</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="ow">or</span> <span class="n">source_i</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">read_surface_points</span><span class="p">(</span><span class="n">source_i</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                     <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source_o</span><span class="p">,</span> <span class="n">pn</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="ow">or</span> <span class="n">source_o</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">read_orientations</span><span class="p">(</span><span class="n">source_o</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">add_basement</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">add_surface</span><span class="p">([</span><span class="s1">&#39;basement&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">map_stack_to_surfaces</span><span class="p">({</span><span class="s1">&#39;Basement&#39;</span><span class="p">:</span> <span class="s1">&#39;basement&#39;</span><span class="p">},</span> <span class="n">set_series</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rescaling</span><span class="o">.</span><span class="n">rescale_data</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">update_structure</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">update_default_kriging</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Project.get_data"><a class="viewcode-back" href="../../../Model/gempy.core.model.Project.html#gempy.core.model.Project.get_data">[docs]</a>    <span class="nd">@_setdoc_pro</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itype</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">numeric</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to return the data stored in :class:`panda.DataFrame` within a</span>
<span class="sd">        :class:`gempy.core.model.Project` data object.</span>

<span class="sd">        Args:</span>
<span class="sd">            itype: [s_itype]</span>
<span class="sd">            numeric(bool): Return only the numerical values of the dataframe. This is much lighter database for storing</span>
<span class="sd">                traces</span>
<span class="sd">            verbosity (int): Number of properties shown</span>

<span class="sd">        Returns:</span>
<span class="sd">            pandas.DataFrame: Data Object df.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">verbosity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">show_par_f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">_columns_rend</span>
            <span class="n">show_par_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">_columns_rend</span>
        <span class="k">elif</span> <span class="n">verbosity</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">show_par_f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">_columns_o_1</span>
            <span class="n">show_par_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">_columns_i_1</span>

        <span class="k">if</span> <span class="n">numeric</span><span class="p">:</span>
            <span class="n">show_par_f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">_columns_o_num</span>
            <span class="n">show_par_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">_columns_i_num</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;float&#39;</span>

        <span class="k">if</span> <span class="n">itype</span> <span class="o">==</span> <span class="s1">&#39;orientations&#39;</span><span class="p">:</span>
            <span class="n">raw_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">show_par_f</span><span class="p">]</span>  <span class="c1"># .astype(dtype)</span>
            <span class="c1"># Be sure that the columns are in order when used for operations</span>
            <span class="k">if</span> <span class="n">numeric</span><span class="p">:</span>
                <span class="n">raw_data</span> <span class="o">=</span> <span class="n">raw_data</span><span class="p">[</span>
                    <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;G_x&#39;</span><span class="p">,</span> <span class="s1">&#39;G_y&#39;</span><span class="p">,</span> <span class="s1">&#39;G_z&#39;</span><span class="p">,</span> <span class="s1">&#39;dip&#39;</span><span class="p">,</span> <span class="s1">&#39;azimuth&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;polarity&#39;</span><span class="p">]]</span>
        <span class="k">elif</span> <span class="n">itype</span> <span class="o">==</span> <span class="s1">&#39;surface_points&#39;</span> <span class="ow">or</span> <span class="n">itype</span> <span class="o">==</span> <span class="s1">&#39;surface points&#39;</span><span class="p">:</span>
            <span class="n">raw_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">show_par_i</span><span class="p">]</span>  <span class="c1"># .astype(dtype)</span>
            <span class="c1"># Be sure that the columns are in order when used for operations</span>
            <span class="k">if</span> <span class="n">numeric</span><span class="p">:</span>
                <span class="n">raw_data</span> <span class="o">=</span> <span class="n">raw_data</span><span class="p">[</span>
                    <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;G_x&#39;</span><span class="p">,</span> <span class="s1">&#39;G_y&#39;</span><span class="p">,</span> <span class="s1">&#39;G_z&#39;</span><span class="p">,</span> <span class="s1">&#39;dip&#39;</span><span class="p">,</span> <span class="s1">&#39;azimuth&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;polarity&#39;</span><span class="p">]]</span>
        <span class="k">elif</span> <span class="n">itype</span> <span class="o">==</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span>
            <span class="n">raw_data</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_surface_points</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">show_par_i</span><span class="p">],</span>  <span class="c1"># .astype(dtype),</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">_orientations</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">show_par_f</span><span class="p">]],</span>  <span class="c1"># .astype(dtype)],</span>
                <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;surface_points&#39;</span><span class="p">,</span> <span class="s1">&#39;orientations&#39;</span><span class="p">],</span>
                <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="c1"># Be sure that the columns are in order when used for operations</span>
            <span class="k">if</span> <span class="n">numeric</span><span class="p">:</span>
                <span class="n">raw_data</span> <span class="o">=</span> <span class="n">raw_data</span><span class="p">[</span>
                    <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;G_x&#39;</span><span class="p">,</span> <span class="s1">&#39;G_y&#39;</span><span class="p">,</span> <span class="s1">&#39;G_z&#39;</span><span class="p">,</span> <span class="s1">&#39;dip&#39;</span><span class="p">,</span> <span class="s1">&#39;azimuth&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;polarity&#39;</span><span class="p">]]</span>

        <span class="k">elif</span> <span class="n">itype</span> <span class="o">==</span> <span class="s1">&#39;surfaces&#39;</span><span class="p">:</span>
            <span class="n">raw_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span>
        <span class="k">elif</span> <span class="n">itype</span> <span class="o">==</span> <span class="s1">&#39;series&#39;</span><span class="p">:</span>
            <span class="n">raw_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stack</span>
        <span class="k">elif</span> <span class="n">itype</span> <span class="o">==</span> <span class="s1">&#39;faults&#39;</span><span class="p">:</span>
            <span class="n">raw_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_faults</span>
        <span class="k">elif</span> <span class="n">itype</span> <span class="o">==</span> <span class="s1">&#39;faults_relations_df&#39;</span> <span class="ow">or</span> <span class="n">itype</span> <span class="o">==</span> <span class="s1">&#39;faults_relations&#39;</span><span class="p">:</span>
            <span class="n">raw_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_faults</span><span class="o">.</span><span class="n">faults_relations_df</span>
        <span class="k">elif</span> <span class="n">itype</span> <span class="o">==</span> <span class="s1">&#39;additional data&#39;</span> <span class="ow">or</span> <span class="n">itype</span> <span class="o">==</span> <span class="s1">&#39;additional_data&#39;</span><span class="p">:</span>
            <span class="n">raw_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span>
        <span class="k">elif</span> <span class="n">itype</span> <span class="o">==</span> <span class="s1">&#39;kriging&#39;</span><span class="p">:</span>
            <span class="n">raw_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">kriging_data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="s1">&#39;itype has to be </span><span class="se">\&#39;</span><span class="s1">data</span><span class="se">\&#39;</span><span class="s1">, </span><span class="se">\&#39;</span><span class="s1">additional data</span><span class="se">\&#39;</span><span class="s1">, </span><span class="se">\&#39;</span><span class="s1">surface_points</span><span class="se">\&#39;</span><span class="s1">, </span><span class="se">\&#39;</span><span class="s1">orientations</span><span class="se">\&#39;</span><span class="s1">,&#39;</span>
                <span class="s1">&#39; </span><span class="se">\&#39;</span><span class="s1">surfaces</span><span class="se">\&#39;</span><span class="s1">,</span><span class="se">\&#39;</span><span class="s1">series</span><span class="se">\&#39;</span><span class="s1">, </span><span class="se">\&#39;</span><span class="s1">faults</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">faults_relations_df</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">raw_data</span></div>

    <span class="k">def</span> <span class="nf">get_additional_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_data</span><span class="o">.</span><span class="n">get_additional_data</span><span class="p">()</span></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../../index.html">
    <img class="logo" src="../../../_static/./logos/gempy.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=cgre-aachen&repo=gempy&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





    

<p>
<a class="badge" href="https://travis-ci.org/cgre-aachen/gempy">
    <img
        alt="https://secure.travis-ci.org/cgre-aachen/gempy.svg?branch=master"
        src="https://secure.travis-ci.org/cgre-aachen/gempy.svg?branch=master"
    />
</a>
</p>


<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../projects.html">Additional projects</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">GemPy Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../integrations/index.html">Integrations</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../code.html">Code</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017-2021, CGRE-Aachen Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>