.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_getting_started_get_started.py>`     to download the full example code
    .. rst-class:: sphx-glr-example-title

    .. _sphx_glr_getting_started_get_started.py:


Getting Started
===============


.. code-block:: python3


    # Importing GemPy
    import gempy as gp

    # Importing aux libraries
    import numpy as np
    import matplotlib.pyplot as plt
    import matplotlib.image as mpimg








Initializing the model:
~~~~~~~~~~~~~~~~~~~~~~~

The first step to create a GemPy model is create a gempy.Model object
that will contain all the other data structures and necessary
functionality.

In addition for this example we will define a regular grid since the
beginning. This is the grid where we will interpolate the 3D geological
model. GemPy comes with an array of different grids for different
pourposes as we will see below. For visualization usually a regular grid
is the one that makes more sense.



.. code-block:: python3

    geo_model = gp.create_model('Model1')
    geo_model = gp.init_data(geo_model, extent=[0, 791, 0, 200, -582, 0], resolution=[100, 10, 100])





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Active grids: ['regular']




GemPy core code is written in Python. However for efficiency (and other
reasons) most of heavy computations happend in optimize compile code,
either C or CUDA for GPU. To do so, GemPy rely on the library theano. To
guarantee maximum optimization theano requires to compile the code for
every Python kernel. The compilation is done by calling the following
line at any point (before computing the model):



.. code-block:: python3

    gp.set_interpolator(geo_model, theano_optimizer='fast_compile', verbose=[])





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Setting kriging parameters to their default values.
    Compiling theano function...
    Level of Optimization:  fast_compile
    Device:  cpu
    Precision:  float64
    Number of faults:  0
    Compilation Done!
    Kriging values: 
                       values
    range             1002.2
    $C_o$            23914.4
    drift equations      [3]

    <gempy.core.interpolator.InterpolatorModel object at 0x7f01fb277160>



Creating figure:
~~~~~~~~~~~~~~~~

GemPy uses matplotlib and pyvista-vtk libraries for 2d and 3d
visualization of the model respectively. One of the design decisions of
GemPy is to allow real time construction of the model. What this means
is that you can start adding input data and see in real time how the 3D
surfaces evolve. Lets initialize the visualization windows.

The first one is the 2d figure. Just place the window where you can see
it (maybe move the jupyter notebook to half screen and use the other
half for the renderers).


%matplotlib qt5


.. code-block:: python3

    p2d = gp.plot_2d(geo_model)




.. image:: /getting_started/images/sphx_glr_get_started_001.png
    :alt: Cell Number: mid Direction: y
    :class: sphx-glr-single-img





Add model section
^^^^^^^^^^^^^^^^^

In the 2d renderer we can add several cross section of the model. In
this case, for simplicity sake we are just adding one perpendicular to
y.


Loading cross-section image:
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Remember that gempy is simply using matplotlib and therofe the ax object
created above is a standard matplotlib axes. This allow to manipulate it
freely. Lets load an image with the information of couple of boreholes


Reading image


.. code-block:: python3

    img = mpimg.imread('wells.png')
    # Plotting it inplace
    p2d = gp.plot_2d(geo_model, show=False)
    p2d.axes[0].imshow(img, origin='upper', alpha=.8, extent=(0, 791, -582, 0))
    plt.show()




.. image:: /getting_started/images/sphx_glr_get_started_002.png
    :alt: Cell Number: mid Direction: y
    :class: sphx-glr-single-img





We can do the same in 3D through pyvista and vtk rendering:



.. code-block:: python3

    p3d = gp.plot_3d(geo_model)




.. image:: /getting_started/images/sphx_glr_get_started_003.png
    :alt: get started
    :class: sphx-glr-single-img





Building the model
------------------

Now that we have everything initialize we can start the construction of
the geological model.

Surfaces
~~~~~~~~

GemPy is a surface based interpolator. This means that all the input
data we add has to be refered to a surface. The surfaces always mark the
bottom of a unit. By default GemPy surfaces are empty:



.. code-block:: python3

    geo_model.surfaces






.. raw:: html

    <style  type="text/css" >
    </style><table id="T_d9436ef2_3884_11eb_afc4_b3a2b3eb1f40" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>    </tr></thead><tbody>
            </tbody></table>
    <br />
    <br />

If we do not care about the names and we just want to interpolate a
surface we can use:


Default surfaces:


.. code-block:: python3

    geo_model.set_default_surfaces()






.. raw:: html

    <style  type="text/css" >
    #T_d9436ef3_3884_11eb_afc4_b3a2b3eb1f40row0_col3{
                background-color:  #015482;
            }#T_d9436ef3_3884_11eb_afc4_b3a2b3eb1f40row1_col3{
                background-color:  #9f0052;
            }</style><table id="T_d9436ef3_3884_11eb_afc4_b3a2b3eb1f40" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>    </tr></thead><tbody>
                    <tr>
                            <th id="T_d9436ef3_3884_11eb_afc4_b3a2b3eb1f40level0_row0" class="row_heading level0 row0" >0</th>
                            <td id="T_d9436ef3_3884_11eb_afc4_b3a2b3eb1f40row0_col0" class="data row0 col0" >surface1</td>
                            <td id="T_d9436ef3_3884_11eb_afc4_b3a2b3eb1f40row0_col1" class="data row0 col1" >Default series</td>
                            <td id="T_d9436ef3_3884_11eb_afc4_b3a2b3eb1f40row0_col2" class="data row0 col2" >1</td>
                            <td id="T_d9436ef3_3884_11eb_afc4_b3a2b3eb1f40row0_col3" class="data row0 col3" >#015482</td>
                            <td id="T_d9436ef3_3884_11eb_afc4_b3a2b3eb1f40row0_col4" class="data row0 col4" >1</td>
                </tr>
                <tr>
                            <th id="T_d9436ef3_3884_11eb_afc4_b3a2b3eb1f40level0_row1" class="row_heading level0 row1" >1</th>
                            <td id="T_d9436ef3_3884_11eb_afc4_b3a2b3eb1f40row1_col0" class="data row1 col0" >surface2</td>
                            <td id="T_d9436ef3_3884_11eb_afc4_b3a2b3eb1f40row1_col1" class="data row1 col1" >Default series</td>
                            <td id="T_d9436ef3_3884_11eb_afc4_b3a2b3eb1f40row1_col2" class="data row1 col2" >2</td>
                            <td id="T_d9436ef3_3884_11eb_afc4_b3a2b3eb1f40row1_col3" class="data row1 col3" >#9f0052</td>
                            <td id="T_d9436ef3_3884_11eb_afc4_b3a2b3eb1f40row1_col4" class="data row1 col4" >2</td>
                </tr>
        </tbody></table>
    <br />
    <br />

Now we can start adding data. GemPy input data consist on surface points
and orientations (perpendicular to the layers). The 2D plot gives you
the X and Z coordinates when hovering the mouse over. We can add a
surface point as follows:


Add a point


.. code-block:: python3

    geo_model.add_surface_points(X=223, Y=0.01, Z=-94, surface='surface1')

    # Plot in 2D
    gp.plot_2d(geo_model, cell_number=11)

    # Plot in 3D
    gp.plot_3d(geo_model)




.. image:: /getting_started/images/sphx_glr_get_started_004.png
    :alt: get started
    :class: sphx-glr-single-img

.. image:: /getting_started/images/sphx_glr_get_started_005.png
    :alt: Cell Number: 11 Direction: y
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <gempy.plot.vista.GemPyToVista object at 0x7f01e388e220>



Now we can add the other two points of the layer:


Add points


.. code-block:: python3

    geo_model.add_surface_points(X=458, Y=0, Z=-107, surface='surface1')
    geo_model.add_surface_points(X=612, Y=0, Z=-14, surface='surface1')

    # Plotting
    gp.plot_2d(geo_model, cell_number=11)
    gp.plot_3d(geo_model)




.. image:: /getting_started/images/sphx_glr_get_started_006.png
    :alt: get started
    :class: sphx-glr-single-img

.. image:: /getting_started/images/sphx_glr_get_started_007.png
    :alt: Cell Number: 11 Direction: y
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <gempy.plot.vista.GemPyToVista object at 0x7f01e39e0c40>



The minimum amount of data to interpolate anything in gempy is: a) 2
surface points per surface b) One orientation per series.

Lets add an orientation anywhere in space:


Adding orientation


.. code-block:: python3

    geo_model.add_orientations(X=350, Y=0, Z=-300, surface='surface1', pole_vector=(0, 0, 1))
    gp.plot_2d(geo_model, cell_number=5)
    gp.plot_3d(geo_model)




.. image:: /getting_started/images/sphx_glr_get_started_008.png
    :alt: get started
    :class: sphx-glr-single-img

.. image:: /getting_started/images/sphx_glr_get_started_009.png
    :alt: Cell Number: 5 Direction: y
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <gempy.plot.vista.GemPyToVista object at 0x7f01fb2a5bb0>



Now we have enough data for finally interpolate!



.. code-block:: python3

    gp.compute_model(geo_model)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none



    Lithology ids 
      [2. 2. 2. ... 2. 2. 2.] 





.. code-block:: python3

    geo_model.additional_data.kriging_data






.. raw:: html

    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>values</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>range</th>
          <td>1002.2</td>
        </tr>
        <tr>
          <th>$C_o$</th>
          <td>23914.4</td>
        </tr>
        <tr>
          <th>drift equations</th>
          <td>[3]</td>
        </tr>
      </tbody>
    </table>
    <br />
    <br />


.. code-block:: python3

    geo_model.additional_data.rescaling_data






.. raw:: html

    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>values</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>rescaling factor</th>
          <td>778</td>
        </tr>
        <tr>
          <th>centers</th>
          <td>[417.5, 0.005, -157.0]</td>
        </tr>
      </tbody>
    </table>
    <br />
    <br />

That is, we have interpolated the 3D surface. We can visualize:


In 2D


.. code-block:: python3

    gp.plot_2d(geo_model, cell_number=[5])

    # In 3D
    gp.plot_3d(geo_model, show_surfaces=True)




.. image:: /getting_started/images/sphx_glr_get_started_010.png
    :alt: get started
    :class: sphx-glr-single-img

.. image:: /getting_started/images/sphx_glr_get_started_011.png
    :alt: Cell Number: 5 Direction: y
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <gempy.plot.vista.GemPyToVista object at 0x7f01f9d8a6d0>



Adding more layers:
~~~~~~~~~~~~~~~~~~~

So far we only need 2 units defined. The cross-section image that we
load have 4 however. Lets add two layers more:



.. code-block:: python3

    geo_model.surfaces






.. raw:: html

    <style  type="text/css" >
    #T_dab4e860_3884_11eb_afc4_b3a2b3eb1f40row0_col3{
                background-color:  #015482;
            }#T_dab4e860_3884_11eb_afc4_b3a2b3eb1f40row1_col3{
                background-color:  #9f0052;
            }</style><table id="T_dab4e860_3884_11eb_afc4_b3a2b3eb1f40" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>    </tr></thead><tbody>
                    <tr>
                            <th id="T_dab4e860_3884_11eb_afc4_b3a2b3eb1f40level0_row0" class="row_heading level0 row0" >0</th>
                            <td id="T_dab4e860_3884_11eb_afc4_b3a2b3eb1f40row0_col0" class="data row0 col0" >surface1</td>
                            <td id="T_dab4e860_3884_11eb_afc4_b3a2b3eb1f40row0_col1" class="data row0 col1" >Default series</td>
                            <td id="T_dab4e860_3884_11eb_afc4_b3a2b3eb1f40row0_col2" class="data row0 col2" >1</td>
                            <td id="T_dab4e860_3884_11eb_afc4_b3a2b3eb1f40row0_col3" class="data row0 col3" >#015482</td>
                            <td id="T_dab4e860_3884_11eb_afc4_b3a2b3eb1f40row0_col4" class="data row0 col4" >1</td>
                </tr>
                <tr>
                            <th id="T_dab4e860_3884_11eb_afc4_b3a2b3eb1f40level0_row1" class="row_heading level0 row1" >1</th>
                            <td id="T_dab4e860_3884_11eb_afc4_b3a2b3eb1f40row1_col0" class="data row1 col0" >surface2</td>
                            <td id="T_dab4e860_3884_11eb_afc4_b3a2b3eb1f40row1_col1" class="data row1 col1" >Default series</td>
                            <td id="T_dab4e860_3884_11eb_afc4_b3a2b3eb1f40row1_col2" class="data row1 col2" >2</td>
                            <td id="T_dab4e860_3884_11eb_afc4_b3a2b3eb1f40row1_col3" class="data row1 col3" >#9f0052</td>
                            <td id="T_dab4e860_3884_11eb_afc4_b3a2b3eb1f40row1_col4" class="data row1 col4" >2</td>
                </tr>
        </tbody></table>
    <br />
    <br />


.. code-block:: python3

    geo_model.series






.. raw:: html

    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>order_series</th>
          <th>BottomRelation</th>
          <th>isActive</th>
          <th>isFault</th>
          <th>isFinite</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>Default series</th>
          <td>1</td>
          <td>Erosion</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
        </tr>
      </tbody>
    </table>
    <br />
    <br />


.. code-block:: python3

    geo_model.add_surfaces(['surface3', 'basement'])






.. raw:: html

    <style  type="text/css" >
    #T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row0_col3{
                background-color:  #015482;
            }#T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row1_col3{
                background-color:  #9f0052;
            }#T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row2_col3{
                background-color:  #ffbe00;
            }#T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row3_col3{
                background-color:  #728f02;
            }</style><table id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>    </tr></thead><tbody>
                    <tr>
                            <th id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40level0_row0" class="row_heading level0 row0" >0</th>
                            <td id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row0_col0" class="data row0 col0" >surface1</td>
                            <td id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row0_col1" class="data row0 col1" >Default series</td>
                            <td id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row0_col2" class="data row0 col2" >1</td>
                            <td id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row0_col3" class="data row0 col3" >#015482</td>
                            <td id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row0_col4" class="data row0 col4" >1</td>
                </tr>
                <tr>
                            <th id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40level0_row1" class="row_heading level0 row1" >1</th>
                            <td id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row1_col0" class="data row1 col0" >surface2</td>
                            <td id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row1_col1" class="data row1 col1" >Default series</td>
                            <td id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row1_col2" class="data row1 col2" >2</td>
                            <td id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row1_col3" class="data row1 col3" >#9f0052</td>
                            <td id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row1_col4" class="data row1 col4" >2</td>
                </tr>
                <tr>
                            <th id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40level0_row2" class="row_heading level0 row2" >2</th>
                            <td id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row2_col0" class="data row2 col0" >surface3</td>
                            <td id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row2_col1" class="data row2 col1" >Default series</td>
                            <td id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row2_col2" class="data row2 col2" >3</td>
                            <td id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row2_col3" class="data row2 col3" >#ffbe00</td>
                            <td id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row2_col4" class="data row2 col4" >3</td>
                </tr>
                <tr>
                            <th id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40level0_row3" class="row_heading level0 row3" >3</th>
                            <td id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row3_col0" class="data row3 col0" >basement</td>
                            <td id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row3_col1" class="data row3 col1" >Default series</td>
                            <td id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row3_col2" class="data row3 col2" >4</td>
                            <td id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row3_col3" class="data row3 col3" >#728f02</td>
                            <td id="T_dab4e861_3884_11eb_afc4_b3a2b3eb1f40row3_col4" class="data row3 col4" >4</td>
                </tr>
        </tbody></table>
    <br />
    <br />

Layer 2
~~~~~~~

Add the layer next layers:


Your code here:


.. code-block:: python3

    geo_model.add_surface_points(X=225, Y=0, Z=-269, surface='surface2')
    geo_model.add_surface_points(X=459, Y=0, Z=-279, surface='surface2')

    # --------------------






.. raw:: html

    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>X</th>
          <th>Y</th>
          <th>Z</th>
          <th>smooth</th>
          <th>surface</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>223.0</td>
          <td>0.01</td>
          <td>-94.0</td>
          <td>0.000001</td>
          <td>surface1</td>
        </tr>
        <tr>
          <th>1</th>
          <td>458.0</td>
          <td>0.00</td>
          <td>-107.0</td>
          <td>0.000001</td>
          <td>surface1</td>
        </tr>
        <tr>
          <th>2</th>
          <td>612.0</td>
          <td>0.00</td>
          <td>-14.0</td>
          <td>0.000001</td>
          <td>surface1</td>
        </tr>
        <tr>
          <th>3</th>
          <td>225.0</td>
          <td>0.00</td>
          <td>-269.0</td>
          <td>0.000001</td>
          <td>surface2</td>
        </tr>
        <tr>
          <th>4</th>
          <td>459.0</td>
          <td>0.00</td>
          <td>-279.0</td>
          <td>0.000001</td>
          <td>surface2</td>
        </tr>
      </tbody>
    </table>
    <br />
    <br />

Compute model


.. code-block:: python3

    gp.compute_model(geo_model)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none



    Lithology ids 
      [4. 4. 4. ... 2. 2. 2.] 





.. code-block:: python3

    gp.plot_2d(geo_model, cell_number=5, legend='force')
    gp.plot_3d(geo_model)




.. image:: /getting_started/images/sphx_glr_get_started_012.png
    :alt: get started
    :class: sphx-glr-single-img

.. image:: /getting_started/images/sphx_glr_get_started_013.png
    :alt: Cell Number: 5 Direction: y
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <gempy.plot.vista.GemPyToVista object at 0x7f01cff66940>



Layer 3
~~~~~~~


Your code here:


.. code-block:: python3

    geo_model.add_surface_points(X=225, Y=0, Z=-439, surface='surface3')
    geo_model.add_surface_points(X=464, Y=0, Z=-456, surface='surface3')
    geo_model.add_surface_points(X=619, Y=0, Z=-433, surface='surface3')

    # ------------------






.. raw:: html

    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>X</th>
          <th>Y</th>
          <th>Z</th>
          <th>smooth</th>
          <th>surface</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>223.0</td>
          <td>0.01</td>
          <td>-94.0</td>
          <td>0.000001</td>
          <td>surface1</td>
        </tr>
        <tr>
          <th>1</th>
          <td>458.0</td>
          <td>0.00</td>
          <td>-107.0</td>
          <td>0.000001</td>
          <td>surface1</td>
        </tr>
        <tr>
          <th>2</th>
          <td>612.0</td>
          <td>0.00</td>
          <td>-14.0</td>
          <td>0.000001</td>
          <td>surface1</td>
        </tr>
        <tr>
          <th>3</th>
          <td>225.0</td>
          <td>0.00</td>
          <td>-269.0</td>
          <td>0.000001</td>
          <td>surface2</td>
        </tr>
        <tr>
          <th>4</th>
          <td>459.0</td>
          <td>0.00</td>
          <td>-279.0</td>
          <td>0.000001</td>
          <td>surface2</td>
        </tr>
        <tr>
          <th>5</th>
          <td>225.0</td>
          <td>0.00</td>
          <td>-439.0</td>
          <td>0.000001</td>
          <td>surface3</td>
        </tr>
        <tr>
          <th>6</th>
          <td>464.0</td>
          <td>0.00</td>
          <td>-456.0</td>
          <td>0.000001</td>
          <td>surface3</td>
        </tr>
        <tr>
          <th>7</th>
          <td>619.0</td>
          <td>0.00</td>
          <td>-433.0</td>
          <td>0.000001</td>
          <td>surface3</td>
        </tr>
      </tbody>
    </table>
    <br />
    <br />

Computing and plotting 3D


.. code-block:: python3

    gp.compute_model(geo_model)

    gp.plot_2d(geo_model, cell_number=5, legend='force')
    gp.plot_3d(geo_model, kwargs_plot_structured_grid={'opacity': .2})




.. image:: /getting_started/images/sphx_glr_get_started_014.png
    :alt: get started
    :class: sphx-glr-single-img

.. image:: /getting_started/images/sphx_glr_get_started_015.png
    :alt: Cell Number: 5 Direction: y
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <gempy.plot.vista.GemPyToVista object at 0x7f01cc2d5850>



Adding a Fault
--------------

So far the model is simply a depositional unit. GemPy allows for
unconformities and faults to build complex models. This input is given
by categorical data. In general:

input data (surface points/ orientations) <belong to< surface <belong
to< series

And series can be a fault—i.e. offset the rest of surface— or not. We
are going to show how to add a fault as an example.

First we need to add a series:



.. code-block:: python3

    geo_model.add_features('Fault1')






.. raw:: html

    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>order_series</th>
          <th>BottomRelation</th>
          <th>isActive</th>
          <th>isFault</th>
          <th>isFinite</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>Default series</th>
          <td>1</td>
          <td>Erosion</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Fault1</th>
          <td>2</td>
          <td>Erosion</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
        </tr>
      </tbody>
    </table>
    <br />
    <br />


.. code-block:: python3

    geo_model.reorder_features(['Fault1', 'Default series'])






.. raw:: html

    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>order_series</th>
          <th>BottomRelation</th>
          <th>isActive</th>
          <th>isFault</th>
          <th>isFinite</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>Fault1</th>
          <td>1</td>
          <td>Erosion</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Default series</th>
          <td>2</td>
          <td>Erosion</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
        </tr>
      </tbody>
    </table>
    <br />
    <br />

Then define that is a fault:



.. code-block:: python3

    geo_model.set_is_fault('Fault1')





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Fault colors changed. If you do not like this behavior, set change_color to False.


.. raw:: html

    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>order_series</th>
          <th>BottomRelation</th>
          <th>isActive</th>
          <th>isFault</th>
          <th>isFinite</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>Fault1</th>
          <td>1</td>
          <td>Fault</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Default series</th>
          <td>2</td>
          <td>Erosion</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
        </tr>
      </tbody>
    </table>
    <br />
    <br />

But we also need to add a new surface:



.. code-block:: python3

    geo_model.add_surfaces('fault1')






.. raw:: html

    <style  type="text/css" >
    #T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row0_col3{
                background-color:  #015482;
            }#T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row1_col3{
                background-color:  #9f0052;
            }#T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row2_col3{
                background-color:  #ffbe00;
            }#T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row3_col3{
                background-color:  #728f02;
            }#T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row4_col3{
                background-color:  #443988;
            }</style><table id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>    </tr></thead><tbody>
                    <tr>
                            <th id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40level0_row0" class="row_heading level0 row0" >0</th>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row0_col0" class="data row0 col0" >surface1</td>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row0_col1" class="data row0 col1" >Default series</td>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row0_col2" class="data row0 col2" >1</td>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row0_col3" class="data row0 col3" >#015482</td>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row0_col4" class="data row0 col4" >1</td>
                </tr>
                <tr>
                            <th id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40level0_row1" class="row_heading level0 row1" >1</th>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row1_col0" class="data row1 col0" >surface2</td>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row1_col1" class="data row1 col1" >Default series</td>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row1_col2" class="data row1 col2" >2</td>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row1_col3" class="data row1 col3" >#9f0052</td>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row1_col4" class="data row1 col4" >2</td>
                </tr>
                <tr>
                            <th id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40level0_row2" class="row_heading level0 row2" >2</th>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row2_col0" class="data row2 col0" >surface3</td>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row2_col1" class="data row2 col1" >Default series</td>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row2_col2" class="data row2 col2" >3</td>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row2_col3" class="data row2 col3" >#ffbe00</td>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row2_col4" class="data row2 col4" >3</td>
                </tr>
                <tr>
                            <th id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40level0_row3" class="row_heading level0 row3" >3</th>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row3_col0" class="data row3 col0" >basement</td>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row3_col1" class="data row3 col1" >Default series</td>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row3_col2" class="data row3 col2" >4</td>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row3_col3" class="data row3 col3" >#728f02</td>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row3_col4" class="data row3 col4" >4</td>
                </tr>
                <tr>
                            <th id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40level0_row4" class="row_heading level0 row4" >4</th>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row4_col0" class="data row4 col0" >fault1</td>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row4_col1" class="data row4 col1" >Default series</td>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row4_col2" class="data row4 col2" >5</td>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row4_col3" class="data row4 col3" >#443988</td>
                            <td id="T_dbf5467a_3884_11eb_afc4_b3a2b3eb1f40row4_col4" class="data row4 col4" >5</td>
                </tr>
        </tbody></table>
    <br />
    <br />

And finally assign the new surface to the new series/fault



.. code-block:: python3

    gp.map_stack_to_surfaces(geo_model, {'Fault1': 'fault1'})






.. raw:: html

    <style  type="text/css" >
    #T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row0_col3{
                background-color:  #443988;
            }#T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row1_col3{
                background-color:  #015482;
            }#T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row2_col3{
                background-color:  #9f0052;
            }#T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row3_col3{
                background-color:  #ffbe00;
            }#T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row4_col3{
                background-color:  #728f02;
            }</style><table id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>    </tr></thead><tbody>
                    <tr>
                            <th id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40level0_row0" class="row_heading level0 row0" >4</th>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row0_col0" class="data row0 col0" >fault1</td>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row0_col1" class="data row0 col1" >Fault1</td>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row0_col2" class="data row0 col2" >1</td>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row0_col3" class="data row0 col3" >#443988</td>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row0_col4" class="data row0 col4" >1</td>
                </tr>
                <tr>
                            <th id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40level0_row1" class="row_heading level0 row1" >0</th>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row1_col0" class="data row1 col0" >surface1</td>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row1_col1" class="data row1 col1" >Default series</td>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row1_col2" class="data row1 col2" >1</td>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row1_col3" class="data row1 col3" >#015482</td>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row1_col4" class="data row1 col4" >2</td>
                </tr>
                <tr>
                            <th id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40level0_row2" class="row_heading level0 row2" >1</th>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row2_col0" class="data row2 col0" >surface2</td>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row2_col1" class="data row2 col1" >Default series</td>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row2_col2" class="data row2 col2" >2</td>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row2_col3" class="data row2 col3" >#9f0052</td>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row2_col4" class="data row2 col4" >3</td>
                </tr>
                <tr>
                            <th id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40level0_row3" class="row_heading level0 row3" >2</th>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row3_col0" class="data row3 col0" >surface3</td>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row3_col1" class="data row3 col1" >Default series</td>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row3_col2" class="data row3 col2" >3</td>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row3_col3" class="data row3 col3" >#ffbe00</td>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row3_col4" class="data row3 col4" >4</td>
                </tr>
                <tr>
                            <th id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40level0_row4" class="row_heading level0 row4" >3</th>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row4_col0" class="data row4 col0" >basement</td>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row4_col1" class="data row4 col1" >Default series</td>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row4_col2" class="data row4 col2" >4</td>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row4_col3" class="data row4 col3" >#728f02</td>
                            <td id="T_dbf5467b_3884_11eb_afc4_b3a2b3eb1f40row4_col4" class="data row4 col4" >5</td>
                </tr>
        </tbody></table>
    <br />
    <br />

Now we can just add input data as before (remember the minimum amount of
input data to compute a model):


Add input data of the fault


.. code-block:: python3

    geo_model.add_surface_points(X=550, Y=0, Z=-30, surface='fault1')
    geo_model.add_surface_points(X=650, Y=0, Z=-200, surface='fault1')
    geo_model.add_orientations(X=600, Y=0, Z=-100, surface='fault1', pole_vector=(.3, 0, .3))

    # Plotting Inpute data
    gp.plot_2d(geo_model, show_solutions=False)




.. image:: /getting_started/images/sphx_glr_get_started_016.png
    :alt: Cell Number: mid Direction: y
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <gempy.plot.visualization_2d.Plot2D object at 0x7f01cc21f6d0>



And now is computing as before:


Compute


.. code-block:: python3

    gp.compute_model(geo_model)

    # Plot
    gp.plot_2d(geo_model, cell_number=5, legend='force')
    gp.plot_3d(geo_model, kwargs_plot_structured_grid={'opacity': .2})




.. image:: /getting_started/images/sphx_glr_get_started_017.png
    :alt: get started
    :class: sphx-glr-single-img

.. image:: /getting_started/images/sphx_glr_get_started_018.png
    :alt: Cell Number: 5 Direction: y
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <gempy.plot.vista.GemPyToVista object at 0x7f01c91d01f0>



As you can see now instead of having folding layers we have a sharp
jump. Building on this you can pretty much any model you can imagine.


Additional features:
====================

Over the years we have built a bunch of assets integrate with gempy.
Here we will show some of them:

Topography
----------

GemPy has a built-in capabilities to read and manipulate topographic
data (through gdal). To show an example we can just create a random
topography:


Adding random topography


.. code-block:: python3

    geo_model.set_topography(source='random', fd=1.9, d_z=np.array([-150, 0]),
                             resolution=np.array([200, 200]))





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Active grids: ['regular' 'topography']

    Grid Object. Values: 
    array([[   3.955     ,   10.        , -579.09      ],
           [   3.955     ,   10.        , -573.27      ],
           [   3.955     ,   10.        , -567.45      ],
           ...,
           [ 791.        ,  197.98994975, -127.99792609],
           [ 791.        ,  198.99497487, -125.81816698],
           [ 791.        ,  200.        , -123.36674889]])



The topography can we visualize in both renderers:



.. code-block:: python3

    gp.plot_2d(geo_model, cell_number=5, legend='force')
    gp.plot_3d(geo_model, kwargs_plot_structured_grid={'opacity':.2})




.. image:: /getting_started/images/sphx_glr_get_started_019.png
    :alt: get started
    :class: sphx-glr-single-img

.. image:: /getting_started/images/sphx_glr_get_started_020.png
    :alt: Cell Number: 5 Direction: y
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <gempy.plot.vista.GemPyToVista object at 0x7f01cc171bb0>



But also allows us to compute the geological map of an area:



.. code-block:: python3

    gp.compute_model(geo_model)

    # sphinx_gallery_thumbnail_number = 16
    gp.plot_3d(geo_model, show_topography=True)




.. image:: /getting_started/images/sphx_glr_get_started_021.png
    :alt: get started
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /home/miguel/PycharmProjects/gempy/gempy/core/solution.py:174: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
      self.geological_map = np.array(

    <gempy.plot.vista.GemPyToVista object at 0x7f01cfaaf040>



Gravity inversion
-----------------

GemPy also allows for inversions (in production only gravity so far). We
can see a small demo how this works.

The first thing to do is to assign densities to each of the units:



.. code-block:: python3

    geo_model.add_surface_values([0, 2.6, 2.4, 3.2, 3.6], ['density'])






.. raw:: html

    <style  type="text/css" >
    #T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row0_col3{
                background-color:  #443988;
            }#T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row1_col3{
                background-color:  #015482;
            }#T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row2_col3{
                background-color:  #9f0052;
            }#T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row3_col3{
                background-color:  #ffbe00;
            }#T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row4_col3{
                background-color:  #728f02;
            }</style><table id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>        <th class="col_heading level0 col5" >density</th>    </tr></thead><tbody>
                    <tr>
                            <th id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40level0_row0" class="row_heading level0 row0" >4</th>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row0_col0" class="data row0 col0" >fault1</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row0_col1" class="data row0 col1" >Fault1</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row0_col2" class="data row0 col2" >1</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row0_col3" class="data row0 col3" >#443988</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row0_col4" class="data row0 col4" >1</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row0_col5" class="data row0 col5" >0.000000</td>
                </tr>
                <tr>
                            <th id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40level0_row1" class="row_heading level0 row1" >0</th>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row1_col0" class="data row1 col0" >surface1</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row1_col1" class="data row1 col1" >Default series</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row1_col2" class="data row1 col2" >1</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row1_col3" class="data row1 col3" >#015482</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row1_col4" class="data row1 col4" >2</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row1_col5" class="data row1 col5" >2.600000</td>
                </tr>
                <tr>
                            <th id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40level0_row2" class="row_heading level0 row2" >1</th>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row2_col0" class="data row2 col0" >surface2</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row2_col1" class="data row2 col1" >Default series</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row2_col2" class="data row2 col2" >2</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row2_col3" class="data row2 col3" >#9f0052</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row2_col4" class="data row2 col4" >3</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row2_col5" class="data row2 col5" >2.400000</td>
                </tr>
                <tr>
                            <th id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40level0_row3" class="row_heading level0 row3" >2</th>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row3_col0" class="data row3 col0" >surface3</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row3_col1" class="data row3 col1" >Default series</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row3_col2" class="data row3 col2" >3</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row3_col3" class="data row3 col3" >#ffbe00</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row3_col4" class="data row3 col4" >4</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row3_col5" class="data row3 col5" >3.200000</td>
                </tr>
                <tr>
                            <th id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40level0_row4" class="row_heading level0 row4" >3</th>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row4_col0" class="data row4 col0" >basement</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row4_col1" class="data row4 col1" >Default series</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row4_col2" class="data row4 col2" >4</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row4_col3" class="data row4 col3" >#728f02</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row4_col4" class="data row4 col4" >5</td>
                            <td id="T_dea76ea2_3884_11eb_afc4_b3a2b3eb1f40row4_col5" class="data row4 col5" >3.600000</td>
                </tr>
        </tbody></table>
    <br />
    <br />

Also we can create a centered grid around a device for precision:



.. code-block:: python3

    geo_model.set_centered_grid(centers=[[400, 0, 0]], resolution=[10, 10, 100], radius=800)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Active grids: ['regular' 'topography' 'centered']

    Grid Object. Values: 
    array([[    3.955     ,    10.        ,  -579.09      ],
           [    3.955     ,    10.        ,  -573.27      ],
           [    3.955     ,    10.        ,  -567.45      ],
           ...,
           [ 1200.        ,   800.        ,  -922.71624587],
           [ 1200.        ,   800.        ,  -964.3665184 ],
           [ 1200.        ,   800.        , -1008.        ]])



We need to modify the compile code:



.. code-block:: python3

    gp.set_interpolator(geo_model, output=['gravity'], theano_optimizer='fast_run')





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Setting kriging parameters to their default values.
    Compiling theano function...
    Level of Optimization:  fast_run
    Device:  cpu
    Precision:  float64
    Number of faults:  1
    Compilation Done!
    Kriging values: 
                       values
    range             1002.2
    $C_o$            23914.4
    drift equations   [3, 3]

    <gempy.core.interpolator.InterpolatorModel object at 0x7f01fb277160>



But now additionally to the interpolation we also compute the forward
gravity of the model (at the point XYZ = 400, 0, 0)



.. code-block:: python3

    gp.compute_model(geo_model)
    geo_model.solutions.fw_gravity




.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    array([-80.36323225])




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  24.465 seconds)


.. _sphx_glr_download_getting_started_get_started.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: get_started.py <get_started.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: get_started.ipynb <get_started.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
