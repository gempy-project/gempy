<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Unknown Model: Importing Borehole Data and Building a 3D Geological Model with GemPy &#8212; GemPy 2024.2.0.3.dev0+gf344a731.d20240626 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=270d38c7" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <script src="../../_static/documentation_options.js?v=bd57e1ea"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="External Examples" href="../../external/external_examples.html" />
    <link rel="prev" title="Perth basin." href="Perth_basin.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-examples-real-mik-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="unknown-model-importing-borehole-data-and-building-a-3d-geological-model-with-gempy">
<span id="sphx-glr-examples-real-mik-py"></span><h1>Unknown Model: Importing Borehole Data and Building a 3D Geological Model with GemPy<a class="headerlink" href="#unknown-model-importing-borehole-data-and-building-a-3d-geological-model-with-gempy" title="Link to this heading">¶</a></h1>
<p>In this section, we will explore how to take borehole or drillhole data and convert it into a format compatible with GemPy,
creating a 3D geological model. Borehole data is commonly collected in the mining, oil, and gas industries and contains
information about subsurface geological formations, including lithologies, stratigraphy, and the geometry of layers or faults.</p>
<p>For this, we will rely on several helper functions from the <cite>subsurface</cite> package to extract borehole data and translate it
into a 3D structure that GemPy can use for modeling.
We will cover:</p>
<ul class="simple">
<li><p>Downloading the borehole data</p></li>
<li><p>Processing the data using <cite>subsurface</cite></p></li>
<li><p>Visualizing borehole locations and lithology data in 3D</p></li>
</ul>
<section id="downloading-borehole-data">
<h2>Downloading Borehole Data<a class="headerlink" href="#downloading-borehole-data" title="Link to this heading">¶</a></h2>
<p>The borehole data is hosted online, and we can use the <cite>pooch</cite> library to download it directly. <cite>pooch</cite> is a library for
fetching datasets from the internet. We will download a CSV file that contains the borehole information, including collar
positions, survey data, and lithology logs.</p>
<p>Let’s start by downloading the dataset and inspecting its content.</p>
<p>sphinx_gallery_thumbnail_number = -1</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># List of relative paths used during the workshop</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pooch</span>
<span class="kn">import</span> <span class="nn">pyvista</span>

<span class="kn">from</span> <span class="nn">subsurface.core.geological_formats</span> <span class="kn">import</span> <span class="n">Collars</span><span class="p">,</span> <span class="n">Survey</span><span class="p">,</span> <span class="n">BoreholeSet</span>
<span class="kn">from</span> <span class="nn">subsurface.core.geological_formats.boreholes._combine_trajectories</span> <span class="kn">import</span> <span class="n">MergeOptions</span>
<span class="kn">from</span> <span class="nn">subsurface.core.reader_helpers.readers_data</span> <span class="kn">import</span> <span class="n">GenericReaderFilesHelper</span>
<span class="kn">from</span> <span class="nn">subsurface.core.structs.base_structures.base_structures_enum</span> <span class="kn">import</span> <span class="n">SpecialCellCase</span>
<span class="kn">from</span> <span class="nn">subsurface.modules.reader.wells.read_borehole_interface</span> <span class="kn">import</span> <span class="n">read_collar</span><span class="p">,</span> <span class="n">read_survey</span><span class="p">,</span> <span class="n">read_lith</span>
<span class="kn">import</span> <span class="nn">subsurface</span> <span class="k">as</span> <span class="nn">ss</span>
<span class="kn">from</span> <span class="nn">subsurface.modules.visualization</span> <span class="kn">import</span> <span class="n">to_pyvista_points</span><span class="p">,</span> <span class="n">pv_plot</span><span class="p">,</span> <span class="n">to_pyvista_line</span><span class="p">,</span> <span class="n">init_plotter</span>

<span class="c1"># Importing GemPy</span>
<span class="kn">import</span> <span class="nn">gempy</span> <span class="k">as</span> <span class="nn">gp</span>
</pre></div>
</div>
<p>We use <cite>pooch</cite> to download the dataset into a temp file:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/softwareunderground/subsurface/main/tests/data/borehole/kim_ready.csv&quot;</span>
<span class="n">known_hash</span> <span class="o">=</span> <span class="s2">&quot;a91445cb960526398e25d8c1d2ab3b3a32f7d35feaf33e18887629b242256ab6&quot;</span>

<span class="c1"># Your code here:</span>
<span class="n">raw_borehole_data_csv</span> <span class="o">=</span> <span class="n">pooch</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">known_hash</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we can use <cite>subsurface</cite> function to help us reading csv files into pandas dataframes that the package can understand.
Since the combination of styles data is provided can highly vary from project to project, <cite>subsurface</cite> provides some <em>helpers</em>
functions to parse different combination of .csv</p>
<p>Read the collar data from the CSV</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">collar_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">read_collar</span><span class="p">(</span>
    <span class="n">GenericReaderFilesHelper</span><span class="p">(</span>
        <span class="n">file_or_buffer</span><span class="o">=</span><span class="n">raw_borehole_data_csv</span><span class="p">,</span>
        <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
        <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">],</span>
        <span class="n">columns_map</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span>  <span class="c1"># ? Index name is not mapped</span>
            <span class="s2">&quot;X&quot;</span><span class="p">:</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Y&quot;</span><span class="p">:</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span>
            <span class="s2">&quot;altitude&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span>
        <span class="p">}</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Convert to UnstructuredData</span>
<span class="n">unstruc</span><span class="p">:</span> <span class="n">ss</span><span class="o">.</span><span class="n">UnstructuredData</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">UnstructuredData</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span>
    <span class="n">vertex</span><span class="o">=</span><span class="n">collar_df</span><span class="p">[[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="n">cells</span><span class="o">=</span><span class="n">SpecialCellCase</span><span class="o">.</span><span class="n">POINTS</span>
<span class="p">)</span>

<span class="n">points</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">PointSet</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">unstruc</span><span class="p">)</span>
<span class="n">collars</span><span class="p">:</span> <span class="n">Collars</span> <span class="o">=</span> <span class="n">Collars</span><span class="p">(</span>
    <span class="n">ids</span><span class="o">=</span><span class="n">collar_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span>
    <span class="n">collar_loc</span><span class="o">=</span><span class="n">points</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="visualizing-the-borehole-collars">
<h2>Visualizing the Borehole Collars<a class="headerlink" href="#visualizing-the-borehole-collars" title="Link to this heading">¶</a></h2>
<p>Once we have the borehole collars data, we can visualize them in 3D using the <cite>pyvista</cite> package. This gives us a good
overview of where the boreholes are located in space. In this visualization, each borehole will be represented by a point,
and we will label the boreholes using their IDs.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">well_mesh</span> <span class="o">=</span> <span class="n">to_pyvista_points</span><span class="p">(</span><span class="n">collars</span><span class="o">.</span><span class="n">collar_loc</span><span class="p">)</span>

<span class="c1"># Plot the collar points</span>
<span class="n">pv_plot</span><span class="p">([</span><span class="n">well_mesh</span><span class="p">],</span> <span class="n">image_2d</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_mik_001.png" srcset="../../_images/sphx_glr_mik_001.png" alt="mik" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;pyvista.plotting.plotter.Plotter object at 0x7f3c3d862d70&gt;
</pre></div>
</div>
</section>
<section id="reading-borehole-survey-data">
<h2>Reading Borehole Survey Data<a class="headerlink" href="#reading-borehole-survey-data" title="Link to this heading">¶</a></h2>
<p>Borehole surveys give us information about the trajectory of each borehole, including its depth (measured depth).
The survey data allows us to compute the full 3D path of each wellbore. We will use the <cite>read_survey</cite> function from
<cite>subsurface</cite> to read this data.</p>
<p>Create the Survey object</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">survey_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">read_survey</span><span class="p">(</span>
    <span class="n">GenericReaderFilesHelper</span><span class="p">(</span>
        <span class="n">file_or_buffer</span><span class="o">=</span><span class="n">raw_borehole_data_csv</span><span class="p">,</span>
        <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
        <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;md&quot;</span><span class="p">]</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">survey</span><span class="p">:</span> <span class="n">Survey</span> <span class="o">=</span> <span class="n">Survey</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">survey_df</span><span class="p">)</span>

<span class="n">survey</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/leguark/subsurface/subsurface/modules/reader/wells/read_borehole_interface.py:82: UserWarning: inc and/or azi columns are not present in the file. The boreholes will be straight.
  warnings.warn(

Survey(ids=array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13., 14., 15., 16., 17., 18., 19., 20., 21., 22., 23., 24., 25.,
       26., 27., 28., 29., 30., 31., 32., 33., 34., 35., 36., 37., 38.,
       39., 40., 41., 42., 43., 44., 45., 46., 47., 48., 49., 50., 51.,
       52., 53., 54., 55., 56., 57., 58., 59., 60., 61., 62., 63., 64.,
       65., 66., 67., 68.]), survey_trajectory=&lt;subsurface.core.structs.unstructured_elements.line_set.LineSet object at 0x7f3c3d8be380&gt;, well_id_mapper={&#39;KCL12&#39;: 0, &#39;KCL_B45&#39;: 1, &#39;Russell1&#39;: 2, &#39;CallowayXX&#39;: 3, &#39;KCL15&#39;: 4, &#39;KCL_1144&#39;: 5, &#39;Kramer1&#39;: 6, &#39;Davies1&#39;: 7, &#39;Tidewater_Capital_Co.XX&#39;: 8, &#39;Westates44&#39;: 9, &#39;Roe3&#39;: 10, &#39;RoeXX&#39;: 11, &#39;Helbling1&#39;: 12, &#39;PACIFIC_STATESXX&#39;: 13, &#39;KerncoXX&#39;: 14, &#39;Amalgamated_Happold2&#39;: 15, &#39;DearingerXX&#39;: 16, &#39;St._Anthony1&#39;: 17, &#39;BALD_EAGLE74&#39;: 18, &#39;CURRY1&#39;: 19, &#39;KCL87_25&#39;: 20, &#39;Del_Fortuna1&#39;: 21, &#39;XX32_15&#39;: 22, &#39;Wright_Bloemer74&#39;: 23, &#39;MARQUIS1&#39;: 24, &#39;Famosa12_1&#39;: 25, &#39;Kuhn81_15&#39;: 26, &#39;Bergman_Trust1&#39;: 27, &#39;KCL_A58_8&#39;: 28, &#39;Steele_Petroleum_Co4_1&#39;: 29, &#39;Gow1&#39;: 30, &#39;RUSSELLXX&#39;: 31, &#39;KCL_G1&#39;: 32, &#39;33XX&#39;: 33, &#39;Sharples_Marathon_BillingtonXX&#39;: 34, &#39;Mobil_Pan_Petroleum_KCL31_15&#39;: 35, &#39;Mobil_Pan_Pet_KCL86_35&#39;: 36, &#39;Roberts_Cox23_1&#39;: 37, &#39;Law_et_alXX&#39;: 38, &#39;TennecoXX&#39;: 39, &#39;11&#39;: 40, &#39;Cities_Service_TennecoXX&#39;: 41, &#39;USLXX&#39;: 42, &#39;HayesXX&#39;: 43, &#39;SUPERIOR_TENNECO_GAUTXX&#39;: 44, &#39;TWIXX&#39;: 45, &#39;Tenneco_Ladd_Rio_Bravo_North87&#39;: 46, &#39;Tenneco_Rio_Bravo32&#39;: 47, &#39;McCulloch_Camp_et_al1_36&#39;: 48, &#39;West_Rio_Bravo1&#39;: 49, &#39;Shell_Magee_GlideXX&#39;: 50, &#39;XXXX&#39;: 51, &#39;Wiedman55_26&#39;: 52, &#39;R.A._Shafter_A1&#39;: 53, &#39;KerrXX&#39;: 54, &#39;Bishop_FeeXX&#39;: 55, &#39;API_BartellXX&#39;: 56, &#39;Kimberlina1&#39;: 57, &#39;Kern_AXX&#39;: 58, &#39;Tenneco_Sun11x_31&#39;: 59, &#39;Bishop_FeeXXX&#39;: 60, &#39;Bellevue_Deep1&#39;: 61, &#39;S_&amp;_D_Killingwoth_EPM1&#39;: 62, &#39;Arkelian23_26&#39;: 63, &#39;Ingram13_73&#39;: 64, &#39;Union_Tribe_BXX&#39;: 65, &#39;JewettaXX&#39;: 66, &#39;Golden_State_VintnersXX&#39;: 67, &#39;USLXXX&#39;: 68})
</pre></div>
</div>
</section>
<section id="reading-lithology-data">
<h2>Reading Lithology Data<a class="headerlink" href="#reading-lithology-data" title="Link to this heading">¶</a></h2>
<p>Next, we will read the lithology data. Lithology logs describe the rock type or geological unit encountered at different
depths within each borehole. Using <cite>read_lith</cite>, we will extract the lithology data, which includes the top and base depths
of each geological formation within the borehole, as well as the formation name.</p>
<p>Your code here:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">lith</span> <span class="o">=</span> <span class="n">read_lith</span><span class="p">(</span>
    <span class="n">GenericReaderFilesHelper</span><span class="p">(</span>
        <span class="n">file_or_buffer</span><span class="o">=</span><span class="n">raw_borehole_data_csv</span><span class="p">,</span>
        <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span> <span class="s1">&#39;formation&#39;</span><span class="p">],</span>
        <span class="n">columns_map</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="s1">&#39;top&#39;</span><span class="p">,</span>
            <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span>
            <span class="s1">&#39;formation&#39;</span><span class="p">:</span> <span class="s1">&#39;component lith&#39;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Update survey data with lithology information</span>
<span class="n">survey</span><span class="o">.</span><span class="n">update_survey_with_lith</span><span class="p">(</span><span class="n">lith</span><span class="p">)</span>

<span class="n">lith</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>(&#39;cell&#39;,) are not coordinates with an index xarray dataset must include &#39;cell&#39; key (KeyError) or xarray &#39;cell&#39; has no index (ValueError).
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>top</th>
      <th>base</th>
      <th>component lith</th>
      <th>lith_ids</th>
    </tr>
    <tr>
      <th>name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>KCL12</th>
      <td>0.000000</td>
      <td>1035.597077</td>
      <td>topo</td>
      <td>0</td>
    </tr>
    <tr>
      <th>KCL12</th>
      <td>1035.597077</td>
      <td>1652.245636</td>
      <td>etchegoin</td>
      <td>1</td>
    </tr>
    <tr>
      <th>KCL12</th>
      <td>1652.245636</td>
      <td>2109.993683</td>
      <td>macoma</td>
      <td>2</td>
    </tr>
    <tr>
      <th>KCL12</th>
      <td>2109.984893</td>
      <td>2799.027984</td>
      <td>fruitvale</td>
      <td>3</td>
    </tr>
    <tr>
      <th>KCL12</th>
      <td>2109.993683</td>
      <td>2110.003683</td>
      <td>mclure</td>
      <td>4</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>USLXXX</th>
      <td>601.202972</td>
      <td>753.114075</td>
      <td>vedder</td>
      <td>7</td>
    </tr>
    <tr>
      <th>USLXXX</th>
      <td>753.114075</td>
      <td>1197.413513</td>
      <td>cretaceous</td>
      <td>10</td>
    </tr>
    <tr>
      <th>USLXXX</th>
      <td>1197.413513</td>
      <td>1623.969910</td>
      <td>basement</td>
      <td>11</td>
    </tr>
    <tr>
      <th>USLXXX</th>
      <td>1623.969910</td>
      <td>1623.979910</td>
      <td>NaN</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>USLXXX</th>
      <td>1656.922150</td>
      <td>1656.932150</td>
      <td>topo</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>721 rows × 4 columns</p>
</div>
</div>
<br />
<br /></section>
<section id="creating-a-borehole-set-and-visualizing-in-3d">
<h2>Creating a Borehole Set and Visualizing in 3D<a class="headerlink" href="#creating-a-borehole-set-and-visualizing-in-3d" title="Link to this heading">¶</a></h2>
<p>Now that we have both the collar data and the lithology logs, we can combine them into a <cite>BoreholeSet</cite> object. This object
combines the collar, survey, and lithology data and allows us to create a 3D visualization of the borehole trajectories and
their associated lithologies.</p>
<p>We will use <cite>pyvista</cite> to plot the borehole trajectories as lines, and we will color them according to their lithologies.
Additionally, we will label the collars for easy identification.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Combine collar and survey into a BoreholeSet</span>
<span class="n">borehole_set</span> <span class="o">=</span> <span class="n">BoreholeSet</span><span class="p">(</span>
    <span class="n">collars</span><span class="o">=</span><span class="n">collars</span><span class="p">,</span>
    <span class="n">survey</span><span class="o">=</span><span class="n">survey</span><span class="p">,</span>
    <span class="n">merge_option</span><span class="o">=</span><span class="n">MergeOptions</span><span class="o">.</span><span class="n">INTERSECT</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Visualize boreholes with pyvista</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">well_mesh</span> <span class="o">=</span> <span class="n">to_pyvista_line</span><span class="p">(</span>
    <span class="n">line_set</span><span class="o">=</span><span class="n">borehole_set</span><span class="o">.</span><span class="n">combined_trajectory</span><span class="p">,</span>
    <span class="n">active_scalar</span><span class="o">=</span><span class="s2">&quot;lith_ids&quot;</span><span class="p">,</span>
    <span class="n">radius</span><span class="o">=</span><span class="mi">40</span>
<span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">init_plotter</span><span class="p">()</span>

<span class="c1"># Set colormap for lithologies</span>
<span class="n">boring_cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="n">lut</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">well_mesh</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">boring_cmap</span><span class="p">)</span>

<span class="n">collar_mesh</span> <span class="o">=</span> <span class="n">to_pyvista_points</span><span class="p">(</span><span class="n">collars</span><span class="o">.</span><span class="n">collar_loc</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">collar_mesh</span><span class="p">,</span> <span class="n">render_points_as_spheres</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_point_labels</span><span class="p">(</span>
    <span class="n">points</span><span class="o">=</span><span class="n">collars</span><span class="o">.</span><span class="n">collar_loc</span><span class="o">.</span><span class="n">points</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">collars</span><span class="o">.</span><span class="n">ids</span><span class="p">,</span>
    <span class="n">point_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">shape_opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">bold</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>


<span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_mik_002.png" srcset="../../_images/sphx_glr_mik_002.png" alt="mik" class = "sphx-glr-single-img"/></section>
<section id="structural-elements-from-borehole-set">
<h2>Structural Elements from Borehole Set<a class="headerlink" href="#structural-elements-from-borehole-set" title="Link to this heading">¶</a></h2>
<p>Now that we have successfully imported and visualized the borehole data, we can move on to creating the geological
formations (or structural elements) based on the borehole data. Each lithological unit will be associated with a unique
identifier and a color, allowing us to distinguish between different formations when we visualize the model.</p>
<p>GemPy offers the function <cite>gempy.structural_elements_from_borehole_set</cite>, which extracts these structural elements from
the borehole data and associates each one with a name, ID, and color.</p>
<p>Initialize the color generator for formations</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">colors_generator</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ColorsGenerator</span><span class="p">()</span>

<span class="c1"># Define formations and colors</span>
<span class="n">elements</span> <span class="o">=</span> <a href="../../GemPy API/gempy.structural_elements_from_borehole_set.html#gempy.structural_elements_from_borehole_set" title="gempy.structural_elements_from_borehole_set" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">structural_elements_from_borehole_set</span></a><span class="p">(</span>
    <span class="n">borehole_set</span><span class="o">=</span><span class="n">borehole_set</span><span class="p">,</span>
    <span class="n">elements_dict</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;Basement&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="nb">next</span><span class="p">(</span><span class="n">colors_generator</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="s2">&quot;etchgoin&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="nb">next</span><span class="p">(</span><span class="n">colors_generator</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="s2">&quot;macoma&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="nb">next</span><span class="p">(</span><span class="n">colors_generator</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="s2">&quot;chanac&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="nb">next</span><span class="p">(</span><span class="n">colors_generator</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="s2">&quot;mclure&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="nb">next</span><span class="p">(</span><span class="n">colors_generator</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="s2">&quot;santa_margarita&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="nb">next</span><span class="p">(</span><span class="n">colors_generator</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="s2">&quot;fruitvale&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="nb">next</span><span class="p">(</span><span class="n">colors_generator</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="s2">&quot;round_mountain&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="nb">next</span><span class="p">(</span><span class="n">colors_generator</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="s2">&quot;olcese&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="nb">next</span><span class="p">(</span><span class="n">colors_generator</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="s2">&quot;freeman_jewett&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="nb">next</span><span class="p">(</span><span class="n">colors_generator</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="s2">&quot;vedder&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="nb">next</span><span class="p">(</span><span class="n">colors_generator</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="s2">&quot;eocene&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="nb">next</span><span class="p">(</span><span class="n">colors_generator</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="s2">&quot;cretaceous&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="nb">next</span><span class="p">(</span><span class="n">colors_generator</span><span class="p">)</span>
        <span class="p">},</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="initializing-the-gempy-model">
<h2>Initializing the GemPy Model<a class="headerlink" href="#initializing-the-gempy-model" title="Link to this heading">¶</a></h2>
<p>After defining the geological formations, we need to initialize the GemPy model. The first step in this process is to
create a <cite>GeoModel</cite> object, which serves as the core container for all data related to the geological model.</p>
<p>We will also define a <strong>regular grid</strong> to interpolate the geological layers. GemPy uses a meshless interpolator to
create geological models in 3D space, but grids are convenient for visualization and computation.</p>
<p>GemPy supports various grid types, such as regular grids for visualization, custom grids, topographic grids, and more.
For this example, we will use a regular grid with a medium resolution.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gempy_viewer</span> <span class="k">as</span> <span class="nn">gpv</span>

<span class="c1"># Create a structural group with the elements</span>
<a href="../../Modeling Classes/gempy.core.data.StructuralGroup.html#gempy.core.data.StructuralGroup" title="gempy.core.data.StructuralGroup" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">group</span></a> <span class="o">=</span> <a href="../../Modeling Classes/gempy.core.data.StructuralGroup.html#gempy.core.data.StructuralGroup" title="gempy.core.data.StructuralGroup" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class"><span class="n">gp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">StructuralGroup</span></a><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Stratigraphic Pile&quot;</span><span class="p">,</span>
    <span class="n">elements</span><span class="o">=</span><span class="n">elements</span><span class="p">,</span>
    <span class="n">structural_relation</span><span class="o">=</span><span class="n">gp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">StackRelationType</span><span class="o">.</span><span class="n">ERODE</span>
<span class="p">)</span>

<span class="c1"># Define the structural frame</span>
<a href="../../Modeling Classes/gempy.core.data.StructuralFrame.html#gempy.core.data.StructuralFrame" title="gempy.core.data.StructuralFrame" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">structural_frame</span></a> <span class="o">=</span> <a href="../../Modeling Classes/gempy.core.data.StructuralFrame.html#gempy.core.data.StructuralFrame" title="gempy.core.data.StructuralFrame" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class"><span class="n">gp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">StructuralFrame</span></a><span class="p">(</span>
    <span class="n">structural_groups</span><span class="o">=</span><span class="p">[</span><a href="../../Modeling Classes/gempy.core.data.StructuralGroup.html#gempy.core.data.StructuralGroup" title="gempy.core.data.StructuralGroup" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">group</span></a><span class="p">],</span>
    <span class="n">color_gen</span><span class="o">=</span><span class="n">colors_generator</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="defining-model-extent-and-grid-resolution">
<h2>Defining Model Extent and Grid Resolution<a class="headerlink" href="#defining-model-extent-and-grid-resolution" title="Link to this heading">¶</a></h2>
<p>We now determine the extent of our model based on the surface points provided. This ensures that the grid covers the
entire area where the geological data points are located. Additionally, we set a grid resolution of 50x50x50 for a
balance between performance and model detail.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../Modeling Classes/gempy.core.data.SurfacePointsTable.html#gempy.core.data.SurfacePointsTable" title="gempy.core.data.SurfacePointsTable" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">all_surface_points_coords</span></a><span class="p">:</span> <a href="../../Modeling Classes/gempy.core.data.SurfacePointsTable.html#gempy.core.data.SurfacePointsTable" title="gempy.core.data.SurfacePointsTable" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class"><span class="n">gp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SurfacePointsTable</span></a> <span class="o">=</span> <a href="../../Modeling Classes/gempy.core.data.StructuralFrame.html#gempy.core.data.StructuralFrame.surface_points_copy" title="gempy.core.data.StructuralFrame.surface_points_copy" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-property"><span class="n">structural_frame</span><span class="o">.</span><span class="n">surface_points_copy</span></a>
<span class="n">extent_from_data</span> <span class="o">=</span> <a href="../../Modeling Classes/gempy.core.data.SurfacePointsTable.html#gempy.core.data.SurfacePointsTable" title="gempy.core.data.SurfacePointsTable" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">all_surface_points_coords</span></a><span class="o">.</span><span class="n">xyz</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <a href="../../Modeling Classes/gempy.core.data.SurfacePointsTable.html#gempy.core.data.SurfacePointsTable" title="gempy.core.data.SurfacePointsTable" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">all_surface_points_coords</span></a><span class="o">.</span><span class="n">xyz</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># Initialize GeoModel</span>
<a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a> <span class="o">=</span> <a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class"><span class="n">gp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">GeoModel</span></a><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Stratigraphic Pile&quot;</span><span class="p">,</span>
    <a href="../../Modeling Classes/gempy.core.data.StructuralFrame.html#gempy.core.data.StructuralFrame" title="gempy.core.data.StructuralFrame" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">structural_frame</span></a><span class="o">=</span><a href="../../Modeling Classes/gempy.core.data.StructuralFrame.html#gempy.core.data.StructuralFrame" title="gempy.core.data.StructuralFrame" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">structural_frame</span></a><span class="p">,</span>
    <span class="n">grid</span><span class="o">=</span><a href="../../Modeling Classes/gempy.core.data.Grid.html#gempy.core.data.Grid" title="gempy.core.data.Grid" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class"><span class="n">gp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Grid</span></a><span class="p">(</span>
        <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">extent_from_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">extent_from_data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">extent_from_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">extent_from_data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">extent_from_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">extent_from_data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]],</span>
        <span class="n">resolution</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="n">interpolation_options</span><span class="o">=</span><span class="n">gp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">InterpolationOptions</span><span class="p">(</span>
        <span class="nb">range</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">c_o</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">mesh_extraction</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">number_octree_levels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="d-visualization-of-the-model">
<h2>3D Visualization of the Model<a class="headerlink" href="#d-visualization-of-the-model" title="Link to this heading">¶</a></h2>
<p>After initializing the GeoModel, we can proceed to visualize it in 3D using GemPy’s <cite>plot_3d</cite> function. This function
allows us to see the full 3D geological model with all the defined formations.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gempy_plot</span> <span class="o">=</span> <span class="n">gpv</span><span class="o">.</span><span class="n">plot_3d</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span>
    <span class="n">kwargs_pyvista_bounds</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;show_xlabels&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s1">&#39;show_ylabels&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">image</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_mik_003.png" srcset="../../_images/sphx_glr_mik_003.png" alt="mik" class = "sphx-glr-single-img"/></section>
<section id="adding-boreholes-and-collars-to-the-visualization">
<h2>Adding Boreholes and Collars to the Visualization<a class="headerlink" href="#adding-boreholes-and-collars-to-the-visualization" title="Link to this heading">¶</a></h2>
<p>To enhance the 3D model, we can combine the geological formations with the borehole trajectories and collar points that we
visualized earlier. This will give us a complete picture of the subsurface, showing both the lithological units and the borehole paths.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">sp_mesh</span><span class="p">:</span> <span class="n">pyvista</span><span class="o">.</span><span class="n">PolyData</span> <span class="o">=</span> <span class="n">gempy_plot</span><span class="o">.</span><span class="n">surface_points_mesh</span>

<span class="n">pyvista_plotter</span> <span class="o">=</span> <span class="n">init_plotter</span><span class="p">()</span>
<span class="n">pyvista_plotter</span><span class="o">.</span><span class="n">show_bounds</span><span class="p">(</span><span class="n">all_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Set limits for the units to visualize</span>
<span class="n">units_limit</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">]</span>
<span class="n">pyvista_plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span>
    <span class="n">well_mesh</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">units_limit</span><span class="p">),</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;tab20c&quot;</span><span class="p">,</span>
    <span class="n">clim</span><span class="o">=</span><span class="n">units_limit</span>
<span class="p">)</span>

<span class="c1"># Add collar points</span>
<span class="n">pyvista_plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span>
    <span class="n">collar_mesh</span><span class="p">,</span>
    <span class="n">point_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">render_points_as_spheres</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># Label the collars with their names</span>
<span class="n">pyvista_plotter</span><span class="o">.</span><span class="n">add_point_labels</span><span class="p">(</span>
    <span class="n">points</span><span class="o">=</span><span class="n">collars</span><span class="o">.</span><span class="n">collar_loc</span><span class="o">.</span><span class="n">points</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">collars</span><span class="o">.</span><span class="n">ids</span><span class="p">,</span>
    <span class="n">point_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">shape_opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">bold</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="c1"># Add surface points from the geological model</span>
<span class="n">pyvista_plotter</span><span class="o">.</span><span class="n">add_actor</span><span class="p">(</span><span class="n">gempy_plot</span><span class="o">.</span><span class="n">surface_points_actor</span><span class="p">)</span>

<span class="c1"># Show the final 3D plot</span>
<span class="n">pyvista_plotter</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_mik_004.png" srcset="../../_images/sphx_glr_mik_004.png" alt="mik" class = "sphx-glr-single-img"/></section>
<section id="step-by-step-model-building">
<h2>Step-by-Step Model Building<a class="headerlink" href="#step-by-step-model-building" title="Link to this heading">¶</a></h2>
<p>When building a geological model, it’s often better to proceed step by step, adding one surface at a time, rather
than trying to interpolate all formations at once. This allows for better control over the model and helps avoid
potential issues from noisy or irregular data.</p>
</section>
<section id="adding-surfaces-and-formations">
<h2>Adding Surfaces and Formations<a class="headerlink" href="#adding-surfaces-and-formations" title="Link to this heading">¶</a></h2>
<p>In GemPy, surfaces mark the bottom of each geological unit. For our model, we will add the first two formations
along with the basement, which always needs to be defined. After this, we can visualize the surfaces in 2D.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../Modeling Classes/gempy.core.data.StructuralGroup.html#gempy.core.data.StructuralGroup" title="gempy.core.data.StructuralGroup" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">group</span></a> <span class="o">=</span> <a href="../../Modeling Classes/gempy.core.data.StructuralGroup.html#gempy.core.data.StructuralGroup" title="gempy.core.data.StructuralGroup" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class"><span class="n">gp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">StructuralGroup</span></a><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Stratigraphic Pile Top&quot;</span><span class="p">,</span>
    <span class="n">elements</span><span class="o">=</span><span class="n">elements</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span>
    <span class="n">structural_relation</span><span class="o">=</span><span class="n">gp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">StackRelationType</span><span class="o">.</span><span class="n">ERODE</span>
<span class="p">)</span>
<a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="o">.</span><a href="../../Modeling Classes/gempy.core.data.StructuralFrame.html#gempy.core.data.StructuralFrame" title="gempy.core.data.StructuralFrame" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">structural_frame</span></a><span class="o">.</span><span class="n">structural_groups</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <a href="../../Modeling Classes/gempy.core.data.StructuralGroup.html#gempy.core.data.StructuralGroup" title="gempy.core.data.StructuralGroup" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">group</span></a>


<span class="c1"># Visualize the surfaces in 2D</span>

<span class="n">g2d</span> <span class="o">=</span> <span class="n">gpv</span><span class="o">.</span><span class="n">plot_2d</span><span class="p">(</span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_mik_005.png" srcset="../../_images/sphx_glr_mik_005.png" alt="Cell Number: mid Direction: y" class = "sphx-glr-single-img"/><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">g2d</span><span class="o">.</span><span class="n">fig</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 640x480 with 1 Axes&gt;
</pre></div>
</div>
</section>
<section id="minimum-input-data-for-interpolation">
<h2>Minimum Input Data for Interpolation<a class="headerlink" href="#minimum-input-data-for-interpolation" title="Link to this heading">¶</a></h2>
<p>To interpolate the geological layers, GemPy requires at least:</p>
<ul class="simple">
<li><p>Two surface points per geological unit</p></li>
<li><p>One orientation measurement per series</p></li>
</ul>
<p>Let’s add an orientation for one of the units.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../GemPy API/gempy.add_orientations.html#gempy.add_orientations" title="gempy.add_orientations" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">add_orientations</span></a><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">300000</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">3930000</span><span class="p">],</span>
    <span class="n">z</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">elements_names</span><span class="o">=</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
    <span class="n">pole_vector</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
    <a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="o">=</span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a>
<span class="p">)</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">

        <table>
          <tr><td>Structural Groups:</td><td>
    <table style="border-left:1.2px solid black;>
      <tr><th colspan="2"><b>StructuralGroup:</b></th></tr>
      <tr><td>Name:</td><td>Stratigraphic Pile Top</td></tr>
      <tr><td>Structural Relation:</td><td>StackRelationType.ERODE</td></tr>
      <tr><td>Elements:</td><td>
    <table width="50%" style="border-left:15px solid #015482;">
      <tr><th colspan="2"><b>StructuralElement:</b></th></tr>
      <tr><td>Name:</td><td>Basement</td></tr>
    </table>
        <br>
    <table width="50%" style="border-left:15px solid #9f0052;">
      <tr><th colspan="2"><b>StructuralElement:</b></th></tr>
      <tr><td>Name:</td><td>etchgoin</td></tr>
    </table>
        <br>
    <table width="50%" style="border-left:15px solid #ffbe00;">
      <tr><th colspan="2"><b>StructuralElement:</b></th></tr>
      <tr><td>Name:</td><td>macoma</td></tr>
    </table>
        </td></tr>
    </table>
        </td></tr>
          <tr><td>Fault Relations:</td><td><table style="border-collapse: collapse; table-layout: fixed;"><th></th><th style="transform: rotate(-35deg); height:150px; vertical-align: bottom; text-align: center;">Stratigrap...</th><tr><th>Stratigraphic Pile Top</th><td style="background-color: #FFB6C1; width: 20px; height: 20px; border: 1px solid black;"></td></tr></table></td></tr>
          <tr><td></td><td>
        <table>
          <tr>
            <td><div style="display: inline-block; background-color: #527682; width: 20px; height: 20px; border: 1px solid black;"></div> True</td>
            <td><div style="display: inline-block; background-color: #FFB6C1; width: 20px; height: 20px; border: 1px solid black;"></div> False</td>
          </tr>
        </table>
        </td></tr>
        </table>

</div>
<br />
<br /></section>
<section id="model-computation">
<h2>Model Computation<a class="headerlink" href="#model-computation" title="Link to this heading">¶</a></h2>
<p>Now that we have the necessary surface points and orientations, we can compute the final geological model. The
<cite>compute_model</cite> function will take all the input data and perform the interpolation to generate the 3D subsurface structure.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="o">.</span><span class="n">interpolation_options</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">

                <table>
                    <tr><td colspan='2' style='text-align:center'><b>InterpolationOptions</b></td></tr>
                    <tr><td>kernel_options</td><td>{'range': 5, 'c_o': 10, 'uni_degree': 1, 'i_res': 4, 'gi_res': 2, 'number_dimensions': 3, 'kernel_function': <AvailableKernelFunctions.cubic: KernelFunction(base_function=<function cubic_function at 0x7f3c8d462830>, derivative_div_r=<function cubic_function_p_div_r at 0x7f3c8d4628c0>, second_derivative=<function cubic_function_a at 0x7f3c8d462950>, consume_sq_distance=False)>, 'kernel_solver': <Solvers.DEFAULT: 1>, 'compute_condition_number': False, 'optimizing_condition_number': False, 'condition_number': None}</td></tr><tr><td>evaluation_options</td><td>{'_number_octree_levels': 3, '_number_octree_levels_surface': 4, 'octree_curvature_threshold': -1, 'octree_error_threshold': 1.0, 'octree_min_level': 2, 'mesh_extraction': True, 'mesh_extraction_masking_options': <MeshExtractionMaskingOptions.INTERSECT: 3>, 'mesh_extraction_fancy': True, 'evaluation_chunk_size': 500000, 'compute_scalar_gradient': False, 'verbose': False}</td></tr><tr><td>temp_interpolation_values</td><td><gempy_engine.core.data.options.temp_interpolation_values.TempInterpolationValues object at 0x7f3c3c179f60></td></tr><tr><td>debug</td><td>True</td></tr><tr><td>cache_mode</td><td>CacheMode.IN_MEMORY_CACHE</td></tr><tr><td>cache_model_name</td><td>Stratigraphic Pile</td></tr><tr><td>block_solutions_type</td><td>BlockSolutionType.DENSE_GRID</td></tr><tr><td>sigmoid_slope</td><td>50000</td></tr><tr><td>debug_water_tight</td><td>False</td></tr>
                </table>

</div>
<br />
<br /><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../GemPy API/gempy.compute_model.html#gempy.compute_model" title="gempy.compute_model" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">compute_model</span></a><span class="p">(</span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Setting Backend To: AvailableBackends.numpy
Chunking done: 37 chunks
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<b>Solutions:</b> 3 Octree Levels, 3 DualContouringMeshes
</div>
<br />
<br /></section>
<section id="final-3d-visualization">
<h2>Final 3D Visualization<a class="headerlink" href="#final-3d-visualization" title="Link to this heading">¶</a></h2>
<p>Let’s take a look at the final model, combining the borehole data and geological formations in 3D.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">g3d</span> <span class="o">=</span> <span class="n">gpv</span><span class="o">.</span><span class="n">plot_3d</span><span class="p">(</span><a href="../../Modeling Classes/gempy.core.data.GeoModel.html#gempy.core.data.GeoModel" title="gempy.core.data.GeoModel" class="sphx-glr-backref-module-gempy-core-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">show_lith</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">g3d</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">well_mesh</span><span class="p">)</span>
<span class="n">g3d</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_mik_006.png" srcset="../../_images/sphx_glr_mik_006.png" alt="mik" class = "sphx-glr-single-img"/></section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">¶</a></h2>
<p>In this tutorial, we have demonstrated how to take borehole data and create a 3D geological model in GemPy. We explored
how to extract structural elements from borehole data, set up a regular grid for interpolation, and visualize the
resulting model in both 2D and 3D.</p>
<p>GemPy’s flexibility allows you to iteratively build models and refine your inputs for more accurate results, and it
integrates seamlessly with borehole data for subsurface geological modeling.</p>
<p>For further reading and resources, check out:</p>
</section>
<section id="extra-resources">
<h2>Extra Resources<a class="headerlink" href="#extra-resources" title="Link to this heading">¶</a></h2>
<p>Page:
<a class="reference external" href="https://www.gempy.org/">https://www.gempy.org/</a></p>
<p>Paper:
<a class="reference external" href="https://www.gempy.org/theory">https://www.gempy.org/theory</a></p>
<p>Gitub:
<a class="reference external" href="https://github.com/cgre-aachen/gempy">https://github.com/cgre-aachen/gempy</a></p>
</section>
<section id="further-training-and-collaborations">
<h2>Further training and collaborations<a class="headerlink" href="#further-training-and-collaborations" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://www.terranigma-solutions.com/">https://www.terranigma-solutions.com/</a></p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 11.073 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-real-mik-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/91b4271740953f838c43efba0cfbc333/mik.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">mik.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/b741b9e5724ae0bc04d9a98eefbcd05c/mik.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">mik.py</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logos/gempy.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=gempy-project&repo=gempy&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">GemPy Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#simple-geometries">Simple geometries</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#real-case-studies">Real case studies</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">External examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../external/external_examples.html">External Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api_reference.html">Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_reference.html#data-classes">Data Classes</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Examples</a><ul>
  <li><a href="index.html">Real case studies</a><ul>
      <li>Previous: <a href="Perth_basin.html" title="previous chapter">Perth basin.</a></li>
      <li>Next: <a href="../../external/external_examples.html" title="next chapter">External Examples</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017-2024, Gempy Developers.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/examples/real/mik.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>