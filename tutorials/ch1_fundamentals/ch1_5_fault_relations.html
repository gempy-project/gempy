
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>1.5: Fault relations &#8212; GemPy 2.2.8 documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-rendered-html.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.6: 2D Visualization." href="ch1_6_2d_visualization.html" />
    <link rel="prev" title="1.4: Unconformity relationships" href="ch1_4_onlap_relations.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-tutorials-ch1-fundamentals-ch1-5-fault-relations-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="fault-relations">
<span id="sphx-glr-tutorials-ch1-fundamentals-ch1-5-fault-relations-py"></span><h1>1.5: Fault relations<a class="headerlink" href="#fault-relations" title="Permalink to this headline">¶</a></h1>
<p>Importing gempy</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gempy</span> <span class="k">as</span> <span class="nn">gp</span>

<span class="c1"># Aux imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Importing the function to find the interface</span>
<span class="kn">from</span> <span class="nn">gempy.utils.input_manipulation</span> <span class="kn">import</span> <span class="n">find_interfaces_from_block_bottoms</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.seed.html#numpy.random.seed" title="numpy.random.seed" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span></a><span class="p">(</span><span class="mi">1515</span><span class="p">)</span>
<a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.set_option.html#pandas.set_option" title="pandas.set_option" class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-data"><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span></a><span class="p">(</span><span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>We import a model from an existing folder.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cwd</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.html#os.getcwd" title="os.getcwd" class="sphx-glr-backref-module-os sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span></a><span class="p">()</span>
<span class="k">if</span> <span class="s1">&#39;examples&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cwd</span></a><span class="p">:</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.html#os.getcwd" title="os.getcwd" class="sphx-glr-backref-module-os sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span></a><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;/examples/&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cwd</span></a> <span class="o">+</span> <span class="s1">&#39;/../../&#39;</span>

<a href="../../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Tutorial_ch1-9a_Fault_relations&#39;</span><span class="p">,</span>
                          <span class="n">path</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">+</span> <span class="s1">&#39;data/gempy_models/Tutorial_ch1-9a_Fault_relations&#39;</span><span class="p">,</span>
                          <span class="n">recompile</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Active grids: [&#39;regular&#39;]
Setting kriging parameters to their default values.
Compiling theano function...
Level of Optimization:  fast_compile
Device:  cpu
Precision:  float64
Number of faults:  1
Compilation Done!
Kriging values:
                        values
range                 1732.05
$C_o$                71428.57
drift equations  [3, 3, 3, 3]
nugget grad              0.01
nugget scalar             0.0
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.faults" title="gempy.core.model.ImplicitCoKriging.faults" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">faults</span><span class="o">.</span><span class="n">faults_relations_df</span></a>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fault_series1</th>
      <th>series2</th>
      <th>series1</th>
      <th>basement_series</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>fault_series1</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>series2</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>series1</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>basement_series</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<br />
<br /><div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.faults" title="gempy.core.model.ImplicitCoKriging.faults" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">faults</span></a>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_series</th>
      <th>BottomRelation</th>
      <th>isFault</th>
      <th>isFinite</th>
      <th>isActive</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>fault_series1</th>
      <td>1</td>
      <td>Fault</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>series2</th>
      <td>2</td>
      <td>Erosion</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>series1</th>
      <td>3</td>
      <td>Erosion</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>basement_series</th>
      <td>4</td>
      <td>Erosion</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.surfaces" title="gempy.core.model.ImplicitCoKriging.surfaces" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model</span><span class="o">.</span><span class="n">surfaces</span></a>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<style  type="text/css" >
#T_fb7ea_row0_col3{
            background-color:  #015482;
        }#T_fb7ea_row1_col3{
            background-color:  #9f0052;
        }#T_fb7ea_row2_col3{
            background-color:  #ffbe00;
        }#T_fb7ea_row3_col3{
            background-color:  #728f02;
        }#T_fb7ea_row4_col3{
            background-color:  #443988;
        }#T_fb7ea_row5_col3{
            background-color:  #ff3f20;
        }#T_fb7ea_row6_col3{
            background-color:  #325916;
        }</style><table id="T_fb7ea_" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_fb7ea_level0_row0" class="row_heading level0 row0" >5</th>
                        <td id="T_fb7ea_row0_col0" class="data row0 col0" >fault1</td>
                        <td id="T_fb7ea_row0_col1" class="data row0 col1" >fault_series1</td>
                        <td id="T_fb7ea_row0_col2" class="data row0 col2" >1</td>
                        <td id="T_fb7ea_row0_col3" class="data row0 col3" >#015482</td>
                        <td id="T_fb7ea_row0_col4" class="data row0 col4" >1</td>
            </tr>
            <tr>
                        <th id="T_fb7ea_level0_row1" class="row_heading level0 row1" >7</th>
                        <td id="T_fb7ea_row1_col0" class="data row1 col0" >rock5</td>
                        <td id="T_fb7ea_row1_col1" class="data row1 col1" >series2</td>
                        <td id="T_fb7ea_row1_col2" class="data row1 col2" >1</td>
                        <td id="T_fb7ea_row1_col3" class="data row1 col3" >#9f0052</td>
                        <td id="T_fb7ea_row1_col4" class="data row1 col4" >2</td>
            </tr>
            <tr>
                        <th id="T_fb7ea_level0_row2" class="row_heading level0 row2" >6</th>
                        <td id="T_fb7ea_row2_col0" class="data row2 col0" >rock4</td>
                        <td id="T_fb7ea_row2_col1" class="data row2 col1" >series2</td>
                        <td id="T_fb7ea_row2_col2" class="data row2 col2" >2</td>
                        <td id="T_fb7ea_row2_col3" class="data row2 col3" >#ffbe00</td>
                        <td id="T_fb7ea_row2_col4" class="data row2 col4" >3</td>
            </tr>
            <tr>
                        <th id="T_fb7ea_level0_row3" class="row_heading level0 row3" >0</th>
                        <td id="T_fb7ea_row3_col0" class="data row3 col0" >rock3</td>
                        <td id="T_fb7ea_row3_col1" class="data row3 col1" >series1</td>
                        <td id="T_fb7ea_row3_col2" class="data row3 col2" >1</td>
                        <td id="T_fb7ea_row3_col3" class="data row3 col3" >#728f02</td>
                        <td id="T_fb7ea_row3_col4" class="data row3 col4" >4</td>
            </tr>
            <tr>
                        <th id="T_fb7ea_level0_row4" class="row_heading level0 row4" >3</th>
                        <td id="T_fb7ea_row4_col0" class="data row4 col0" >rock2</td>
                        <td id="T_fb7ea_row4_col1" class="data row4 col1" >series1</td>
                        <td id="T_fb7ea_row4_col2" class="data row4 col2" >2</td>
                        <td id="T_fb7ea_row4_col3" class="data row4 col3" >#443988</td>
                        <td id="T_fb7ea_row4_col4" class="data row4 col4" >5</td>
            </tr>
            <tr>
                        <th id="T_fb7ea_level0_row5" class="row_heading level0 row5" >1</th>
                        <td id="T_fb7ea_row5_col0" class="data row5 col0" >rock1</td>
                        <td id="T_fb7ea_row5_col1" class="data row5 col1" >series1</td>
                        <td id="T_fb7ea_row5_col2" class="data row5 col2" >3</td>
                        <td id="T_fb7ea_row5_col3" class="data row5 col3" >#ff3f20</td>
                        <td id="T_fb7ea_row5_col4" class="data row5 col4" >6</td>
            </tr>
            <tr>
                        <th id="T_fb7ea_level0_row6" class="row_heading level0 row6" >4</th>
                        <td id="T_fb7ea_row6_col0" class="data row6 col0" >basement</td>
                        <td id="T_fb7ea_row6_col1" class="data row6 col1" >basement_series</td>
                        <td id="T_fb7ea_row6_col2" class="data row6 col2" >1</td>
                        <td id="T_fb7ea_row6_col3" class="data row6 col3" >#325916</td>
                        <td id="T_fb7ea_row6_col4" class="data row6 col4" >7</td>
            </tr>
    </tbody></table>
</div>
<br />
<br /><div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../GemPy API/gempy.compute_model.html#gempy.compute_model" title="gempy.compute_model" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">compute_model</span></a><span class="p">(</span><a href="../../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">compute_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Lithology ids
  [7. 7. 7. ... 2. 2. 2.]
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">lith_block</span></a>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>array([7., 7., 7., ..., 2., 2., 2.])
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">block_matrix</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>array([[2., 2., 2., ..., 1., 1., 1.]])
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Plot/gempy.plot_2d.html#gempy.plot_2d" title="gempy.plot_2d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span></a><span class="p">(</span><a href="../../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">,</span> <span class="n">cell_number</span><span class="o">=</span><span class="p">[</span><span class="mi">25</span><span class="p">],</span> <span class="n">show_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Graben example</span>
<span class="c1"># --------------</span>
</pre></div>
</div>
<img alt="Cell Number: 25 Direction: y" class="sphx-glr-single-img" src="../../_images/sphx_glr_ch1_5_fault_relations_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy.plot.visualization_2d.Plot2D object at 0x7fcc46605610&gt;
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model_graben</span></a> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Tutorial_ch1-9b_Fault_relations&#39;</span><span class="p">,</span>
                                 <span class="n">path</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">+</span> <span class="s1">&#39;data/gempy_models/Tutorial_ch1-9b_Fault_relations&#39;</span><span class="p">,</span> <span class="n">recompile</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">project_name</span></a> <span class="o">=</span> <span class="s2">&quot;Faults_relations&quot;</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Active grids: [&#39;regular&#39;]
Setting kriging parameters to their default values.
Compiling theano function...
Level of Optimization:  fast_compile
Device:  cpu
Precision:  float64
Number of faults:  2
Compilation Done!
Kriging values:
                        values
range                 1732.05
$C_o$                71428.57
drift equations  [3, 3, 3, 3]
nugget grad              0.01
nugget scalar             0.0
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.surfaces" title="gempy.core.model.ImplicitCoKriging.surfaces" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model_graben</span><span class="o">.</span><span class="n">surfaces</span></a>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<style  type="text/css" >
#T_4fab4_row0_col3{
            background-color:  #015482;
        }#T_4fab4_row1_col3{
            background-color:  #9f0052;
        }#T_4fab4_row2_col3{
            background-color:  #ffbe00;
        }#T_4fab4_row3_col3{
            background-color:  #728f02;
        }#T_4fab4_row4_col3{
            background-color:  #443988;
        }#T_4fab4_row5_col3{
            background-color:  #ff3f20;
        }#T_4fab4_row6_col3{
            background-color:  #325916;
        }</style><table id="T_4fab4_" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_4fab4_level0_row0" class="row_heading level0 row0" >7</th>
                        <td id="T_4fab4_row0_col0" class="data row0 col0" >fault2</td>
                        <td id="T_4fab4_row0_col1" class="data row0 col1" >fault_series2</td>
                        <td id="T_4fab4_row0_col2" class="data row0 col2" >1</td>
                        <td id="T_4fab4_row0_col3" class="data row0 col3" >#015482</td>
                        <td id="T_4fab4_row0_col4" class="data row0 col4" >1</td>
            </tr>
            <tr>
                        <th id="T_4fab4_level0_row1" class="row_heading level0 row1" >5</th>
                        <td id="T_4fab4_row1_col0" class="data row1 col0" >fault1</td>
                        <td id="T_4fab4_row1_col1" class="data row1 col1" >fault_series1</td>
                        <td id="T_4fab4_row1_col2" class="data row1 col2" >1</td>
                        <td id="T_4fab4_row1_col3" class="data row1 col3" >#9f0052</td>
                        <td id="T_4fab4_row1_col4" class="data row1 col4" >2</td>
            </tr>
            <tr>
                        <th id="T_4fab4_level0_row2" class="row_heading level0 row2" >6</th>
                        <td id="T_4fab4_row2_col0" class="data row2 col0" >rock4</td>
                        <td id="T_4fab4_row2_col1" class="data row2 col1" >series1</td>
                        <td id="T_4fab4_row2_col2" class="data row2 col2" >1</td>
                        <td id="T_4fab4_row2_col3" class="data row2 col3" >#ffbe00</td>
                        <td id="T_4fab4_row2_col4" class="data row2 col4" >3</td>
            </tr>
            <tr>
                        <th id="T_4fab4_level0_row3" class="row_heading level0 row3" >0</th>
                        <td id="T_4fab4_row3_col0" class="data row3 col0" >rock3</td>
                        <td id="T_4fab4_row3_col1" class="data row3 col1" >series1</td>
                        <td id="T_4fab4_row3_col2" class="data row3 col2" >2</td>
                        <td id="T_4fab4_row3_col3" class="data row3 col3" >#728f02</td>
                        <td id="T_4fab4_row3_col4" class="data row3 col4" >4</td>
            </tr>
            <tr>
                        <th id="T_4fab4_level0_row4" class="row_heading level0 row4" >3</th>
                        <td id="T_4fab4_row4_col0" class="data row4 col0" >rock2</td>
                        <td id="T_4fab4_row4_col1" class="data row4 col1" >series1</td>
                        <td id="T_4fab4_row4_col2" class="data row4 col2" >3</td>
                        <td id="T_4fab4_row4_col3" class="data row4 col3" >#443988</td>
                        <td id="T_4fab4_row4_col4" class="data row4 col4" >5</td>
            </tr>
            <tr>
                        <th id="T_4fab4_level0_row5" class="row_heading level0 row5" >1</th>
                        <td id="T_4fab4_row5_col0" class="data row5 col0" >rock1</td>
                        <td id="T_4fab4_row5_col1" class="data row5 col1" >series1</td>
                        <td id="T_4fab4_row5_col2" class="data row5 col2" >4</td>
                        <td id="T_4fab4_row5_col3" class="data row5 col3" >#ff3f20</td>
                        <td id="T_4fab4_row5_col4" class="data row5 col4" >6</td>
            </tr>
            <tr>
                        <th id="T_4fab4_level0_row6" class="row_heading level0 row6" >4</th>
                        <td id="T_4fab4_row6_col0" class="data row6 col0" >basement</td>
                        <td id="T_4fab4_row6_col1" class="data row6 col1" >basement_series</td>
                        <td id="T_4fab4_row6_col2" class="data row6 col2" >1</td>
                        <td id="T_4fab4_row6_col3" class="data row6 col3" >#325916</td>
                        <td id="T_4fab4_row6_col4" class="data row6 col4" >7</td>
            </tr>
    </tbody></table>
</div>
<br />
<br /><div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.additional_data" title="gempy.core.model.ImplicitCoKriging.additional_data" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model_graben</span><span class="o">.</span><span class="n">additional_data</span></a>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>values</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="9" valign="top">Structure</th>
      <th>isLith</th>
      <td>True</td>
    </tr>
    <tr>
      <th>isFault</th>
      <td>True</td>
    </tr>
    <tr>
      <th>number faults</th>
      <td>2</td>
    </tr>
    <tr>
      <th>number surfaces</th>
      <td>6</td>
    </tr>
    <tr>
      <th>number series</th>
      <td>4</td>
    </tr>
    <tr>
      <th>number surfaces per series</th>
      <td>[1, 1, 4, 0]</td>
    </tr>
    <tr>
      <th>len surfaces surface_points</th>
      <td>[9, 9, 15, 15, 12, 12]</td>
    </tr>
    <tr>
      <th>len series surface_points</th>
      <td>[9, 9, 54, 0]</td>
    </tr>
    <tr>
      <th>len series orientations</th>
      <td>[1, 1, 10, 0]</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">Options</th>
      <th>dtype</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>output</th>
      <td>geology</td>
    </tr>
    <tr>
      <th>theano_optimizer</th>
      <td>fast_compile</td>
    </tr>
    <tr>
      <th>device</th>
      <td>cpu</td>
    </tr>
    <tr>
      <th>verbosity</th>
      <td>[0]</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">Kriging</th>
      <th>range</th>
      <td>1732.05</td>
    </tr>
    <tr>
      <th>$C_o$</th>
      <td>71428.57</td>
    </tr>
    <tr>
      <th>drift equations</th>
      <td>[3, 3, 3, 3]</td>
    </tr>
    <tr>
      <th>nugget grad</th>
      <td>0.01</td>
    </tr>
    <tr>
      <th>nugget scalar</th>
      <td>0.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Rescaling</th>
      <th>rescaling factor</th>
      <td>1600.0</td>
    </tr>
    <tr>
      <th>centers</th>
      <td>[500.0, 500.0, -650.0]</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><p>Displaying the input data:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Plot/gempy.plot_2d.html#gempy.plot_2d" title="gempy.plot_2d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span></a><span class="p">(</span><a href="../../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model_graben</span></a><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Cell Number: mid Direction: y" class="sphx-glr-single-img" src="../../_images/sphx_glr_ch1_5_fault_relations_002.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy.plot.visualization_2d.Plot2D object at 0x7fcb8a4c3790&gt;
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Plot/gempy.plot_2d.html#gempy.plot_2d" title="gempy.plot_2d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span></a><span class="p">(</span><a href="../../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model_graben</span></a><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Cell Number: mid Direction: x" class="sphx-glr-single-img" src="../../_images/sphx_glr_ch1_5_fault_relations_003.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy.plot.visualization_2d.Plot2D object at 0x7fcc46088280&gt;
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.stack" title="gempy.core.model.ImplicitCoKriging.stack" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model_graben</span><span class="o">.</span><span class="n">stack</span></a>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_series</th>
      <th>BottomRelation</th>
      <th>isFault</th>
      <th>isFinite</th>
      <th>isActive</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>fault_series2</th>
      <td>1</td>
      <td>Fault</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>fault_series1</th>
      <td>2</td>
      <td>Fault</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>series1</th>
      <td>3</td>
      <td>Erosion</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>basement_series</th>
      <td>4</td>
      <td>Erosion</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.faults" title="gempy.core.model.ImplicitCoKriging.faults" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model_graben</span><span class="o">.</span><span class="n">faults</span></a>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_series</th>
      <th>BottomRelation</th>
      <th>isFault</th>
      <th>isFinite</th>
      <th>isActive</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>fault_series2</th>
      <td>1</td>
      <td>Fault</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>fault_series1</th>
      <td>2</td>
      <td>Fault</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>series1</th>
      <td>3</td>
      <td>Erosion</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>basement_series</th>
      <td>4</td>
      <td>Erosion</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Model/gempy.core.model.ImplicitCoKriging.html#gempy.core.model.ImplicitCoKriging.faults" title="gempy.core.model.ImplicitCoKriging.faults" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-method"><span class="n">geo_model_graben</span><span class="o">.</span><span class="n">faults</span><span class="o">.</span><span class="n">faults_relations_df</span></a>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fault_series2</th>
      <th>fault_series1</th>
      <th>series1</th>
      <th>basement_series</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>fault_series2</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>fault_series1</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>series1</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>basement_series</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<br />
<br /><div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../GemPy API/gempy.compute_model.html#gempy.compute_model" title="gempy.compute_model" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">compute_model</span></a><span class="p">(</span><a href="../../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model_graben</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Lithology ids
  [7. 7. 7. ... 3. 3. 3.]
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Plot/gempy.plot_2d.html#gempy.plot_2d" title="gempy.plot_2d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span></a><span class="p">(</span><a href="../../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model_graben</span></a><span class="p">,</span> <span class="n">cell_number</span><span class="o">=</span><span class="p">[</span><span class="mi">25</span><span class="p">],</span> <span class="n">show_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Cell Number: 25 Direction: y" class="sphx-glr-single-img" src="../../_images/sphx_glr_ch1_5_fault_relations_004.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy.plot.visualization_2d.Plot2D object at 0x7fcb8bfbf1f0&gt;
</pre></div>
</div>
<p>sphinx_gallery_thumbnail_number = 5</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Plot/gempy.plot_3d.html#gempy.plot_3d" title="gempy.plot_3d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_3d</span></a><span class="p">(</span><a href="../../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model_graben</span></a><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="ch1 5 fault relations" class="sphx-glr-single-img" src="../../_images/sphx_glr_ch1_5_fault_relations_005.png" />
<img alt="ch1 5 fault relations" class="sphx-glr-single-img" src="../../_images/sphx_glr_ch1_5_fault_relations_006.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy.plot.vista.GemPyToVista object at 0x7fcbe004be50&gt;
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Plot/gempy.plot_2d.html#gempy.plot_2d" title="gempy.plot_2d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span></a><span class="p">(</span><a href="../../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model_graben</span></a><span class="p">,</span> <span class="n">cell_number</span><span class="o">=</span><span class="p">[</span><span class="mi">25</span><span class="p">],</span> <span class="n">show_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">series_n</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<a href="../../Plot/gempy.plot_2d.html#gempy.plot_2d" title="gempy.plot_2d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span></a><span class="p">(</span><a href="../../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model_graben</span></a><span class="p">,</span> <span class="n">cell_number</span><span class="o">=</span><span class="p">[</span><span class="mi">25</span><span class="p">],</span> <span class="n">show_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">series_n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="Cell Number: 25 Direction: y" class="sphx-glr-multi-img" src="../../_images/sphx_glr_ch1_5_fault_relations_007.png" />
</li>
<li><img alt="Cell Number: 25 Direction: y" class="sphx-glr-multi-img" src="../../_images/sphx_glr_ch1_5_fault_relations_008.png" />
</li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy.plot.visualization_2d.Plot2D object at 0x7fcc418c5220&gt;
</pre></div>
</div>
<div class="section" id="offset-parameter-experimental">
<h2>Offset parameter (Experimental)<a class="headerlink" href="#offset-parameter-experimental" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model_graben</span></a><span class="o">.</span><span class="n">_interpolator</span><span class="o">.</span><span class="n">theano_graph</span><span class="o">.</span><span class="n">offset</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a href="../../GemPy API/gempy.compute_model.html#gempy.compute_model" title="gempy.compute_model" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">compute_model</span></a><span class="p">(</span><a href="../../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model_graben</span></a><span class="p">,</span> <span class="n">compute_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Lithology ids
  [7. 7. 7. ... 3. 3. 3.]
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Plot/gempy.plot_2d.html#gempy.plot_2d" title="gempy.plot_2d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span></a><span class="p">(</span><a href="../../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model_graben</span></a><span class="p">,</span> <span class="n">block</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model_graben</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">block_matrix</span></a><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">125000</span><span class="p">],</span>
           <span class="n">show_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Cell Number: mid Direction: y" class="sphx-glr-single-img" src="../../_images/sphx_glr_ch1_5_fault_relations_009.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy.plot.visualization_2d.Plot2D object at 0x7fcc6b9bc9d0&gt;
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Plot/gempy.plot_2d.html#gempy.plot_2d" title="gempy.plot_2d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span></a><span class="p">(</span><a href="../../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model_graben</span></a><span class="p">,</span> <span class="n">series_n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">show_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Cell Number: mid Direction: y" class="sphx-glr-single-img" src="../../_images/sphx_glr_ch1_5_fault_relations_010.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy.plot.visualization_2d.Plot2D object at 0x7fcc46ee3ca0&gt;
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model_graben</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">scalar_field_matrix</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>array([0.17363373, 0.1848186 , 0.19600352, ..., 1.36450254, 1.37569005,
       1.38687763])
</pre></div>
</div>
<div class="section" id="finding-the-faults-intersection">
<h3>Finding the faults intersection:<a class="headerlink" href="#finding-the-faults-intersection" title="Permalink to this headline">¶</a></h3>
<p>Sometimes we need to find the voxels that contain the each fault. To do
so we can use gempy’s functionality to find interfaces as follows. Lets
use the first fault as an example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="../../Plot/gempy.plot_2d.html#gempy.plot_2d" title="gempy.plot_2d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span></a><span class="p">(</span><a href="../../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model_graben</span></a><span class="p">,</span>
           <span class="n">regular_grid</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model_graben</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">block_matrix</span></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">125000</span><span class="p">],</span>
           <span class="n">show_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Cell Number: mid Direction: y" class="sphx-glr-single-img" src="../../_images/sphx_glr_ch1_5_fault_relations_011.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy.plot.visualization_2d.Plot2D object at 0x7fcb8a4d44c0&gt;
</pre></div>
</div>
<p>Remember the fault block is stored on:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model_graben</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">block_matrix</span></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">125000</span><span class="p">]</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>array([1., 1., 1., ..., 2., 2., 2.])
</pre></div>
</div>
<p>Now we can find where is the intersection of the values 1 by calling the following function.
This will return Trues on those voxels on the intersection</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">intersection</span></a> <span class="o">=</span> <span class="n">find_interfaces_from_block_bottoms</span><span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model_graben</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">block_matrix</span></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">125000</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>We can manually plotting together to see exactly what we have done</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <a href="../../Plot/gempy.plot_2d.html#gempy.plot_2d" title="gempy.plot_2d" class="sphx-glr-backref-module-gempy sphx-glr-backref-type-py-function"><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span></a><span class="p">(</span><a href="../../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model_graben</span></a><span class="p">,</span>
                <span class="n">block</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model_graben</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">block_matrix</span></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">125000</span><span class="p">],</span>
                <span class="n">show_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">intersection</span></a><span class="p">[:,</span> <span class="mi">25</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>

<span class="n">gp</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><a href="../../Model/gempy.core.model.Project.html#gempy.core.model.Project" title="gempy.core.model.Project" class="sphx-glr-backref-module-gempy-core-model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span></a><span class="p">)</span>
</pre></div>
</div>
<img alt="Cell Number: mid Direction: y" class="sphx-glr-single-img" src="../../_images/sphx_glr_ch1_5_fault_relations_012.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  19.931 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorials-ch1-fundamentals-ch1-5-fault-relations-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/934a5a0624d3db1e06a9d886a6cc4e5a/ch1_5_fault_relations.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">ch1_5_fault_relations.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/eb7933b506badaa023fc381051b0a53f/ch1_5_fault_relations.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">ch1_5_fault_relations.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/./logos/gempy.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=cgre-aachen&repo=gempy&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





    

<p>
<a class="badge" href="https://travis-ci.org/cgre-aachen/gempy">
    <img
        alt="https://secure.travis-ci.org/cgre-aachen/gempy.svg?branch=master"
        src="https://secure.travis-ci.org/cgre-aachen/gempy.svg?branch=master"
    />
</a>
</p>


<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../projects.html">Additional projects</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/index.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">GemPy Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#chapter-1-gempy-fundamentals">Chapter 1: GemPy fundamentals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#chapter-2-gempy-geophysics">Chapter 2: GemPy Geophysics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#chapter-3-domain-kriging">Chapter 3: Domain Kriging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#chapter-4-topological-analysis">Chapter 4: Topological analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../integrations/index.html">Integrations</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../code.html">Code</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">GemPy Tutorials</a><ul>
      <li>Previous: <a href="ch1_4_onlap_relations.html" title="previous chapter">1.4: Unconformity relationships</a></li>
      <li>Next: <a href="ch1_6_2d_visualization.html" title="next chapter">1.6: 2D Visualization.</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017-2021, CGRE-Aachen Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/tutorials/ch1_fundamentals/ch1_5_fault_relations.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>